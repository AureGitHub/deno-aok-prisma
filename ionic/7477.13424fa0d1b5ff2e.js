"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7477],{7477:(U,f,a)=>{a.r(f),a.d(f,{GastosPageModule:()=>H});var _=a(4755),g=a(9401),l=a(7002),y=a(7147),m=a(9915),u=a(5861),h=a(1699),d=a(9722),T=a(5916),x=a(6575),t=a(2504),w=a(7241),C=a(5591),M=a(6014),v=a(3380);function b(o,s){1&o&&t._UZ(0,"ion-icon",21)}function Z(o,s){1&o&&t._UZ(0,"ion-icon",22)}function P(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"ion-col",16)(1,"span",17),t.NdJ("click",function(){const c=t.CHM(e).$implicit,r=t.oxw();return t.KtG(r.setOrder(c))}),t._uU(2),t.qZA(),t._UZ(3,"ion-icon"),t.YNc(4,b,1,0,"ion-icon",18),t.YNc(5,Z,1,0,"ion-icon",19),t._UZ(6,"ion-icon"),t.TgZ(7,"ion-icon",20),t.NdJ("click",function(){const c=t.CHM(e).$implicit,r=t.oxw();return t.KtG(r.setFilter(c))}),t.qZA()()}if(2&o){const e=s.$implicit;t.xp6(2),t.Oqu(e.name),t.xp6(2),t.Q6J("ngIf","A"==e.order),t.xp6(1),t.Q6J("ngIf","D"==e.order)}}function O(o,s){1&o&&(t.TgZ(0,"ion-row")(1,"ion-col"),t._UZ(2,"ion-spinner",23),t.qZA()())}function A(o,s){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"span",29),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit,c=t.oxw().$implicit,r=t.oxw();return t.KtG(r.alert(c[i.prop+"_title"]))}),t._uU(2),t.qZA(),t.BQk()}if(2&o){const e=t.oxw().$implicit,n=t.oxw().$implicit;t.xp6(1),t.s9C("title",n[e.prop+"_title"]),t.xp6(1),t.Oqu(n[e.prop])}}function S(o,s){if(1&o&&(t.ynx(0),t.TgZ(1,"span"),t._uU(2),t.qZA(),t.BQk()),2&o){const e=t.oxw().$implicit,n=t.oxw().$implicit;t.xp6(2),t.Oqu(n[e.prop])}}function k(o,s){if(1&o&&(t.TgZ(0,"ion-col"),t.ynx(1,26),t.YNc(2,A,3,2,"ng-container",27),t.YNc(3,S,3,1,"ng-container",28),t.BQk(),t.qZA()),2&o){const e=s.$implicit;t.xp6(1),t.Q6J("ngSwitch",e.type),t.xp6(1),t.Q6J("ngSwitchCase","text")}}function G(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"ion-row",24),t.NdJ("click",function(){const c=t.CHM(e).$implicit,r=t.oxw();return t.KtG(r.onSelect(c))}),t.YNc(1,k,4,2,"ion-col",25),t.qZA()}if(2&o){const e=s.$implicit,n=s.index,i=t.oxw();t.Udp("background-color",n%2?"#C8E5F8":"white")("font-weight",i.rowSelected==e?"bold":"normal"),t.xp6(1),t.Q6J("ngForOf",i.columns)}}function E(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"ion-col",30)(1,"span",17),t.NdJ("click",function(){const c=t.CHM(e).$implicit,r=t.oxw();return t.KtG(r.pagination(c))}),t._uU(2),t.qZA()()}if(2&o){const e=s.$implicit,n=t.oxw();t.ekj("page_actual",n.pageActual===e),t.xp6(2),t.Oqu(e)}}function J(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",31)(3,"ion-button",32),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.cancel())}),t._uU(4,"Cancelar"),t.qZA()(),t.TgZ(5,"ion-title"),t._uU(6),t.qZA(),t.TgZ(7,"ion-buttons",33)(8,"ion-button",34),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.confirm())}),t._uU(9,"Filtrar"),t.qZA()()()(),t.TgZ(10,"ion-content",35)(11,"ion-item")(12,"ion-label",36),t._uU(13,"Contiene.."),t.qZA(),t.TgZ(14,"ion-input",37),t.NdJ("ngModelChange",function(i){t.CHM(e);const c=t.oxw();return t.KtG(c.filterText=i)}),t.qZA()()()}if(2&o){const e=t.oxw();t.xp6(6),t.hij("Filtro para ",e.colSelectForFilter.name,""),t.xp6(2),t.Q6J("strong",!0),t.xp6(6),t.Q6J("ngModel",e.filterText)}}let F=(()=>{class o{set setRow(e){this.rows=this.formatRows(e)}set setCount(e){this.count=e,this.numberPagination=Math.trunc(this.count/this.limit),this.numberPagination+=this.count%this.limit?1:0;for(let n=1;n<=this.numberPagination&&n<6;n++)this.lstPaginacion.push(n)}constructor(){this.rowSelected=null,this.isLoading=!1,this.title="",this.columns=[],this.rows=[],this.isModalOpen=!1,this.filterText="",this.count=0,this.lstPaginacion=[],this.pageActual=1,this.limit=0,this.consulta=new t.vpe,this.page=new t.vpe,this.selected=new t.vpe}ngOnInit(){this.consulta.emit({offset:0,columns:this.columns})}formatRows(e){return e.forEach(n=>{this.columns.forEach(i=>{n[i.prop]&&"text"==i.type&&(n[`${i.prop}_title`]=n[i.prop],n[i.prop]=n[i.prop].substring(0,5).padEnd(8,"."))})}),e}pagination(e){if(this.pageActual==e)return;this.pageActual=e;let n=[e];e-1>0&&n.unshift(e-1),e-2>0&&n.unshift(e-2),e+1<=this.numberPagination&&n.push(e+1),e+2<=this.numberPagination&&n.push(e+2);const i=n.length,c=Math.max(...n);for(let p=1;p<=5-i;p++)c+p<=this.numberPagination&&n.push(c+p);const r=Math.min(...n);for(let p=1;p<=5-i;p++)r-p>0&&n.unshift(r-p);this.lstPaginacion=n,this.page.emit({offset:e-1,columns:this.columns})}onSelect(e){this.rowSelected=this.rowSelected==e?null:e,this.selected.emit(this.rowSelected)}setOrder(e){e.order?"A"!=e.order?"D"!=e.order||(e.order=null):e.order="D":e.order="A"}setFilter(e){this.isModalOpen=!0,this.colSelectForFilter=e}cancel(){this.isModalOpen=!1}confirm(){this.modal.dismiss(this.filterText,"confirm")}onWillDismiss(e){const n=e;"confirm"===n.detail.role&&(this.isModalOpen=!1,this.colSelectForFilter.filter=n.detail.data)}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["my-table"]],viewQuery:function(e,n){if(1&e&&t.Gf(l.ki,5),2&e){let i;t.iGM(i=t.CRH())&&(n.modal=i.first)}},inputs:{isLoading:"isLoading",title:"title",columns:"columns",setRow:"setRow",setCount:"setCount",limit:"limit"},outputs:{consulta:"consulta",page:"page",selected:"selected"},decls:27,vars:13,consts:[[3,"fixed"],[1,"title"],["size","12"],[1,"cabecera-row"],["class","cabecera-titulo",4,"ngFor","ngForOf"],[4,"ngIf"],["class","dato-row",3,"background-color","font-weight","click",4,"ngFor","ngForOf"],[1,"footer-row"],["size","3",1,"pagination-info"],["name","play-skip-back-outline",1,"hand",3,"click"],["name","chevron-back-outline",1,"hand",3,"click"],["class","number-pagination",3,"page_actual",4,"ngFor","ngForOf"],["name","chevron-forward-outline",1,"hand",3,"click"],[1,"pagination-end"],["name","play-skip-forward-outline",1,"hand",3,"click"],[3,"isOpen","willDismiss"],[1,"cabecera-titulo"],[1,"hand",3,"click"],["class","cabecera-icons","name","arrow-up-outline",4,"ngIf"],["class","cabecera-icons","name","arrow-down-outline",4,"ngIf"],["id","open-modal","name","filter-outline",1,"cabecera-icons","hand",3,"click"],["name","arrow-up-outline",1,"cabecera-icons"],["name","arrow-down-outline",1,"cabecera-icons"],["name","dots"],[1,"dato-row",3,"click"],[4,"ngFor","ngForOf"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[3,"title","click"],[1,"number-pagination"],["slot","start"],[3,"click"],["slot","end"],[3,"strong","click"],[1,"ion-padding"],["position","stacked"],["type","text","placeholder","",3,"ngModel","ngModelChange"]],template:function(e,n){1&e&&(t._uU(0),t.ALo(1,"json"),t.TgZ(2,"ion-grid",0)(3,"ion-row",1)(4,"ion-col",2),t._uU(5),t.qZA()(),t.TgZ(6,"ion-row",3),t.YNc(7,P,8,3,"ion-col",4),t.qZA(),t.YNc(8,O,3,0,"ion-row",5),t.YNc(9,G,2,5,"ion-row",6),t.TgZ(10,"ion-row",7)(11,"ion-col",8)(12,"span"),t._uU(13),t.qZA(),t.TgZ(14,"span"),t._uU(15),t.qZA()(),t.TgZ(16,"ion-col")(17,"ion-icon",9),t.NdJ("click",function(){return n.pagination(1)}),t.qZA()(),t.TgZ(18,"ion-col")(19,"ion-icon",10),t.NdJ("click",function(){return n.pageActual>1&&n.pagination(n.pageActual-1)}),t.qZA()(),t.YNc(20,E,3,3,"ion-col",11),t.TgZ(21,"ion-col")(22,"ion-icon",12),t.NdJ("click",function(){return n.pageActual<n.numberPagination&&n.pagination(n.pageActual+1)}),t.qZA()(),t.TgZ(23,"ion-col",13)(24,"ion-icon",14),t.NdJ("click",function(){return n.pagination(n.numberPagination)}),t.qZA()()()(),t.TgZ(25,"ion-modal",15),t.NdJ("willDismiss",function(c){return n.onWillDismiss(c)}),t.YNc(26,J,15,3,"ng-template"),t.qZA()),2&e&&(t.hij("",t.lcZ(1,11,n.columns),"\n"),t.xp6(2),t.Q6J("fixed",!0),t.xp6(3),t.Oqu(n.title),t.xp6(2),t.Q6J("ngForOf",n.columns),t.xp6(1),t.Q6J("ngIf",n.isLoading),t.xp6(1),t.Q6J("ngForOf",n.rows),t.xp6(4),t.AsE("",n.rows.length,"/",n.count," total"),t.xp6(2),t.hij("",n.numberPagination," p\xe1ginas"),t.xp6(5),t.Q6J("ngForOf",n.lstPaginacion),t.xp6(5),t.Q6J("isOpen",n.isModalOpen))},dependencies:[_.sg,_.O5,_.RF,_.n9,_.ED,l.YG,l.Sm,l.wI,l.W2,l.jY,l.Gu,l.gu,l.pK,l.Ie,l.Q$,l.Nd,l.PQ,l.wd,l.sr,l.ki,l.j9,g.JJ,g.On,_.Ts],styles:[".title[_ngcontent-%COMP%]{text-align:center;background-color:#fff;font-size:18px}.cabecera-row[_ngcontent-%COMP%]{display:flex;align-items:center;text-align:left;color:#fff;background-color:#444242;font-weight:700;font-size:14px;height:40px}.dato-row[_ngcontent-%COMP%]{font-size:14px;text-align:left;border:solid 1px rgba(221,218,218,.89)}.footer-row[_ngcontent-%COMP%]{display:flex;align-items:center;height:40px;border:solid 1px black;padding:3px;margin-top:2px;font-size:10px;background-color:#f5f5f5}ion-icon[_ngcontent-%COMP%]{font-size:14px}.number-pagination[_ngcontent-%COMP%]{font-size:14px;text-align:center}.page_actual[_ngcontent-%COMP%]{background-color:navy;color:#fff}.pagination-end[_ngcontent-%COMP%]{display:flex;flex-direction:row}.pagination-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-content:center}.cabecera-icons[_ngcontent-%COMP%]{color:#fff;font-size:20px}.cabecera-titulo[_ngcontent-%COMP%]{display:flex;flex-direction:row}"]}),o})();function N(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div")(1,"app-editor-entity",3),t.NdJ("saveEvent",function(i){t.CHM(e);const c=t.oxw();return t.KtG(c.save(i))})("deleteEvent",function(i){t.CHM(e);const c=t.oxw();return t.KtG(c.borrar(i))})("cancelEvent",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.cancelToolEntity())}),t.qZA()()}if(2&o){const e=t.oxw();t.xp6(1),t.Q6J("entity",e.entitySelected)("setEntity",e.entityDescripcion)("isSaving",e.isSaving)("isDeleting",e.isDeleting)("isAlta",e.isAlta)}}const D=[{path:"",component:(()=>{class o extends T.t{constructor(e,n,i){super(e),this.myHttpService=e,this.utilService=n,this.seguridadService=i,this.columns=[{name:"Fecha",prop:"fecha_p"},{name:"Tipo",prop:"descripcion"},{name:"Importe",prop:"importe"},{name:"Obs",prop:"obs_p",type:"text"}],this.entityName="gasto"}ngOnInit(){var e=this;return(0,u.Z)(function*(){e.user=e.seguridadService.UserGet()})()}setConsulta(e){var n=this;return(0,u.Z)(function*(){yield n.setPage(e)})()}setPage(e){var n=this;return(0,u.Z)(function*(){n.myHttpService.page.offset=e.offset,n.myHttpService.columns=e.columns;const i=new d.a("get",n.app,n.entityName);n.isLoading=!0,n.lstPrincipal=[];const c=yield n.myHttpService.ejecuteURL(i);n.lstPrincipal=c.data,n.myHttpService.page.count=c.count,yield n.ownloadList(),n.isLoading=!1})()}addToolEntity(){this.addToolEntityBase();const e=this.utilService.toISOString(new Date);this.entitySelected={fecha:e},this.entityDescripcion=h.Z.giveMeEntity(this.entityName)}selectItem(e){var n=this;return(0,u.Z)(function*(){if(!e)return n.entityDescripcion=null,void(n.entitySelected=null);n.selectItemBase(),"servicio"!=e.descripcion||n.user.role==x.u.GOD?(n.entitySelected=e,n.entityDescripcion=h.Z.giveMeEntity(n.entityName)):yield n.utilService.alert("Los gastos de tipo servicios no se pueden modificar/borrar")})()}save(e){var n=this;return(0,u.Z)(function*(){n.isSaving=!0;const i=n.isAlta?"post":"put",c=n.isAlta?null:e[n.pk].toString(),r=new d.a(i,n.app,n.entityName,null,e,c);yield n.myHttpService.ejecuteURL(r),n.entityDescripcion=null,n.isSaving=!1,n.setPage({offset:n.myHttpService.page.offset})})()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(d.y),t.Y36(w.f),t.Y36(C.F))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-gastos"]],features:[t.qOj],decls:3,vars:9,consts:[[3,"isLoading","entityDescripcion","addToolEntity","cancelToolEntity"],[4,"ngIf"],[3,"isLoading","title","columns","setRow","limit","setCount","consulta","page","selected"],[3,"entity","setEntity","isSaving","isDeleting","isAlta","saveEvent","deleteEvent","cancelEvent"]],template:function(e,n){1&e&&(t.TgZ(0,"app-tool-entity",0),t.NdJ("addToolEntity",function(){return n.addToolEntity()})("cancelToolEntity",function(){return n.cancelToolEntity()}),t.qZA(),t.YNc(1,N,2,5,"div",1),t.TgZ(2,"my-table",2),t.NdJ("consulta",function(c){return n.setConsulta(c)})("page",function(c){return n.setPage(c)})("selected",function(c){return n.selectItem(c)}),t.qZA()),2&e&&(t.Q6J("isLoading",n.isLoading)("entityDescripcion",n.entityDescripcion),t.xp6(1),t.Q6J("ngIf",n.entityDescripcion),t.xp6(1),t.Q6J("isLoading",n.isLoading)("title","Gastos")("columns",n.columns)("setRow",n.lstPrincipal)("limit",n.myHttpService.page.limit)("setCount",n.myHttpService.page.count))},dependencies:[_.O5,M.G,v.d,F],styles:[".tableTitle[_ngcontent-%COMP%]{text-align:center;color:#fff;background-color:#444242;font-weight:700;font-size:14px}.tableRow[_ngcontent-%COMP%]{text-align:center;font-size:13px;border:1px solid;cursor:pointer;color:#000;background-color:#fff}.tableRow_pendientecobro[_ngcontent-%COMP%]{border:solid 1px red}.tableRowSeleded[_ngcontent-%COMP%]{text-align:center;color:#fff;background-color:#00008b;cursor:pointer}.tableRow[_ngcontent-%COMP%]:hover{color:#fff;background-color:#00008b}"]}),o})()}];let Q=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[m.Bz.forChild(D),m.Bz]}),o})(),H=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[_.ez,g.u5,l.Pc,Q,y.q]}),o})()}}]);