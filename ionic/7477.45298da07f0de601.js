"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7477],{7477:(N,f,c)=>{c.r(f),c.d(f,{GastosPageModule:()=>J});var g=c(4755),y=c(9401),p=c(7002),h=c(7147),m=c(9915),u=c(5861),_=c(1699),d=c(9722),v=c(5916),T=c(6575),t=c(2504),w=c(7241),C=c(5591),M=c(6014),P=c(3380);function b(o,s){if(1&o&&(t.TgZ(0,"ion-col"),t._uU(1),t.qZA()),2&o){const n=s.$implicit;t.xp6(1),t.Oqu(n.name)}}function Z(o,s){1&o&&(t.TgZ(0,"ion-row")(1,"ion-col"),t._UZ(2,"ion-spinner",14),t.qZA()())}function x(o,s){if(1&o&&(t.TgZ(0,"ion-col"),t._uU(1),t.qZA()),2&o){const n=s.$implicit,e=t.oxw().$implicit;t.xp6(1),t.Oqu(e[n.prop])}}function S(o,s){if(1&o){const n=t.EpF();t.TgZ(0,"ion-row",15),t.NdJ("click",function(){const a=t.CHM(n).$implicit,r=t.oxw();return t.KtG(r.onSelect(a))}),t.YNc(1,x,2,1,"ion-col",4),t.qZA()}if(2&o){const n=s.$implicit,e=s.index,i=t.oxw();t.Udp("background-color",e%2?"#C8E5F8":"white")("font-weight",i.rowSelected==n?"bold":"normal"),t.xp6(1),t.Q6J("ngForOf",i.columns)}}function A(o,s){if(1&o){const n=t.EpF();t.TgZ(0,"ion-col",16)(1,"span",17),t.NdJ("click",function(){const a=t.CHM(n).$implicit,r=t.oxw();return t.KtG(r.pagination(a))}),t._uU(2),t.qZA()()}if(2&o){const n=s.$implicit,e=t.oxw();t.ekj("page_actual",e.pageActual===n),t.xp6(2),t.Oqu(n)}}let O=(()=>{class o{set setCount(n){this.count=n,this.numberPagination=Math.trunc(this.count/this.limit),this.numberPagination+=this.count%this.limit?1:0;for(let e=1;e<=this.numberPagination&&e<6;e++)this.lstPaginacion.push(e)}constructor(){this.rowSelected=null,this.isLoading=!1,this.title="",this.columns=[],this.rows=[],this.count=0,this.lstPaginacion=[],this.pageActual=1,this.limit=0,this.page=new t.vpe,this.selected=new t.vpe}ngOnInit(){}pagination(n){if(this.pageActual==n)return;this.pageActual=n;let e=[n];n-1>0&&e.unshift(n-1),n-2>0&&e.unshift(n-2),n+1<=this.numberPagination&&e.push(n+1),n+2<=this.numberPagination&&e.push(n+2);const i=e.length,a=Math.max(...e);for(let l=1;l<=5-i;l++)a+l<=this.numberPagination&&e.push(a+l);const r=Math.min(...e);for(let l=1;l<=5-i;l++)r-l>0&&e.unshift(r-l);this.lstPaginacion=e,this.page.emit({offset:n-1})}onSelect(n){this.rowSelected=this.rowSelected==n?null:n,this.selected.emit(this.rowSelected)}}return o.\u0275fac=function(n){return new(n||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["my-table"]],inputs:{isLoading:"isLoading",title:"title",columns:"columns",rows:"rows",setCount:"setCount",limit:"limit"},outputs:{page:"page",selected:"selected"},decls:22,vars:9,consts:[[3,"fixed"],[1,"title"],["size","12"],[1,"cabecera-row"],[4,"ngFor","ngForOf"],[4,"ngIf"],["class","dato-row",3,"background-color","font-weight","click",4,"ngFor","ngForOf"],[1,"footer-row"],["size","2"],["name","play-skip-back-outline",1,"hand",3,"click"],["name","chevron-back-outline",1,"hand",3,"click"],["class","number-pagination",3,"page_actual",4,"ngFor","ngForOf"],["name","chevron-forward-outline",1,"hand",3,"click"],["name","play-skip-forward-outline",1,"hand",3,"click"],["name","dots"],[1,"dato-row",3,"click"],[1,"number-pagination"],[1,"hand",3,"click"]],template:function(n,e){1&n&&(t.TgZ(0,"ion-grid",0)(1,"ion-row",1)(2,"ion-col",2),t._uU(3),t.qZA()(),t.TgZ(4,"ion-row",3),t.YNc(5,b,2,1,"ion-col",4),t.qZA(),t.YNc(6,Z,3,0,"ion-row",5),t.YNc(7,S,2,5,"ion-row",6),t.TgZ(8,"ion-row",7)(9,"ion-col",8),t._uU(10),t.qZA(),t.TgZ(11,"ion-col",8),t._uU(12),t.qZA(),t.TgZ(13,"ion-col")(14,"ion-icon",9),t.NdJ("click",function(){return e.pagination(1)}),t.qZA()(),t.TgZ(15,"ion-col")(16,"ion-icon",10),t.NdJ("click",function(){return e.pageActual>1&&e.pagination(e.pageActual-1)}),t.qZA()(),t.YNc(17,A,3,3,"ion-col",11),t.TgZ(18,"ion-col")(19,"ion-icon",12),t.NdJ("click",function(){return e.pageActual<e.numberPagination&&e.pagination(e.pageActual+1)}),t.qZA()(),t.TgZ(20,"ion-col")(21,"ion-icon",13),t.NdJ("click",function(){return e.pagination(e.numberPagination)}),t.qZA()()()()),2&n&&(t.Q6J("fixed",!0),t.xp6(3),t.Oqu(e.title),t.xp6(2),t.Q6J("ngForOf",e.columns),t.xp6(1),t.Q6J("ngIf",e.isLoading),t.xp6(1),t.Q6J("ngForOf",e.rows),t.xp6(3),t.AsE("",e.rows.length,"/",e.count," total"),t.xp6(2),t.hij("",e.numberPagination," paginas"),t.xp6(5),t.Q6J("ngForOf",e.lstPaginacion))},dependencies:[g.sg,g.O5,p.wI,p.jY,p.gu,p.Nd,p.PQ],styles:[".title[_ngcontent-%COMP%]{text-align:center;background-color:#fff;font-size:18px}.cabecera-row[_ngcontent-%COMP%]{display:flex;align-items:center;text-align:left;color:#fff;background-color:#444242;font-weight:700;font-size:14px;height:40px}.dato-row[_ngcontent-%COMP%]{font-size:14px;text-align:left;border:solid 1px rgba(221,218,218,.89)}.footer-row[_ngcontent-%COMP%]{display:flex;align-items:center;height:30px;border:solid 1px black;padding:3px;margin-top:2px;font-size:10px;background-color:#f5f5f5}ion-icon[_ngcontent-%COMP%]{font-size:14px}.number-pagination[_ngcontent-%COMP%]{font-size:14px;text-align:center}.page_actual[_ngcontent-%COMP%]{background-color:navy;color:#fff}"]}),o})();function G(o,s){if(1&o){const n=t.EpF();t.TgZ(0,"div")(1,"app-editor-entity",3),t.NdJ("saveEvent",function(i){t.CHM(n);const a=t.oxw();return t.KtG(a.save(i))})("deleteEvent",function(i){t.CHM(n);const a=t.oxw();return t.KtG(a.borrar(i))})("cancelEvent",function(){t.CHM(n);const i=t.oxw();return t.KtG(i.cancelToolEntity())}),t.qZA()()}if(2&o){const n=t.oxw();t.xp6(1),t.Q6J("entity",n.entitySelected)("setEntity",n.entityDescripcion)("isSaving",n.isSaving)("isDeleting",n.isDeleting)("isAlta",n.isAlta)}}const E=[{path:"",component:(()=>{class o extends v.t{constructor(n,e,i){super(n),this.myHttpService=n,this.utilService=e,this.seguridadService=i,this.columns=[{name:"Fecha",prop:"fecha_p"},{name:"Tipo",prop:"descripcion"},{name:"Importe",prop:"importe"},{name:"Obs",prop:"obs_p"}],this.entityName="gasto"}ngOnInit(){var n=this;return(0,u.Z)(function*(){n.user=n.seguridadService.UserGet(),n.setPage({offset:0})})()}setPage(n){var e=this;return(0,u.Z)(function*(){e.myHttpService.page.offset=n.offset;const i=new d.a("get",e.app,e.entityName);e.isLoading=!0,e.lstPrincipal=[];const a=yield e.myHttpService.ejecuteURL(i);e.lstPrincipal=a.data,e.myHttpService.page.count=a.count,yield e.ownloadList(),e.isLoading=!1})()}addToolEntity(){this.addToolEntityBase();const n=this.utilService.toISOString(new Date);this.entitySelected={fecha:n},this.entityDescripcion=_.Z.giveMeEntity(this.entityName)}selectItem(n){var e=this;return(0,u.Z)(function*(){if(!n)return e.entityDescripcion=null,void(e.entitySelected=null);e.selectItemBase(),"servicio"!=n.descripcion||e.user.role==T.u.GOD?(e.entitySelected=n,e.entityDescripcion=_.Z.giveMeEntity(e.entityName)):yield e.utilService.alert("Los gastos de tipo servicios no se pueden modificar/borrar")})()}save(n){var e=this;return(0,u.Z)(function*(){e.isSaving=!0;const i=e.isAlta?"post":"put",a=e.isAlta?null:n[e.pk].toString(),r=new d.a(i,e.app,e.entityName,null,n,a);yield e.myHttpService.ejecuteURL(r),e.entityDescripcion=null,e.isSaving=!1,e.setPage({offset:e.myHttpService.page.offset})})()}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(d.y),t.Y36(w.f),t.Y36(C.F))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-gastos"]],features:[t.qOj],decls:3,vars:9,consts:[[3,"isLoading","entityDescripcion","addToolEntity","cancelToolEntity"],[4,"ngIf"],[3,"isLoading","title","columns","rows","limit","setCount","page","selected"],[3,"entity","setEntity","isSaving","isDeleting","isAlta","saveEvent","deleteEvent","cancelEvent"]],template:function(n,e){1&n&&(t.TgZ(0,"app-tool-entity",0),t.NdJ("addToolEntity",function(){return e.addToolEntity()})("cancelToolEntity",function(){return e.cancelToolEntity()}),t.qZA(),t.YNc(1,G,2,5,"div",1),t.TgZ(2,"my-table",2),t.NdJ("page",function(a){return e.setPage(a)})("selected",function(a){return e.selectItem(a)}),t.qZA()),2&n&&(t.Q6J("isLoading",e.isLoading)("entityDescripcion",e.entityDescripcion),t.xp6(1),t.Q6J("ngIf",e.entityDescripcion),t.xp6(1),t.Q6J("isLoading",e.isLoading)("title","Gastos")("columns",e.columns)("rows",e.lstPrincipal)("limit",e.myHttpService.page.limit)("setCount",e.myHttpService.page.count))},dependencies:[g.O5,M.G,P.d,O],styles:[".tableTitle[_ngcontent-%COMP%]{text-align:center;color:#fff;background-color:#444242;font-weight:700;font-size:14px}.tableRow[_ngcontent-%COMP%]{text-align:center;font-size:13px;border:1px solid;cursor:pointer;color:#000;background-color:#fff}.tableRow_pendientecobro[_ngcontent-%COMP%]{border:solid 1px red}.tableRowSeleded[_ngcontent-%COMP%]{text-align:center;color:#fff;background-color:#00008b;cursor:pointer}.tableRow[_ngcontent-%COMP%]:hover{color:#fff;background-color:#00008b}"]}),o})()}];let k=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[m.Bz.forChild(E),m.Bz]}),o})(),J=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[g.ez,y.u5,p.Pc,k,h.q]}),o})()}}]);