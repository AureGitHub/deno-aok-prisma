"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4295],{4295:(N,p,s)=>{s.r(p),s.d(p,{BizumPagePageModule:()=>P});var f=s(6814),m=s(95),i=s(2511),l=s(242),g=s(3044),c=s(5861),e=s(6689);const h=function(){return{class:"enNaranja",condicion:"row['estadoid'] == 1"}},y=function(){return{class:"enVerde",condicion:"row['estadoid'] == 2"}},v=function(){return{class:"enGris",condicion:"row['estadoid'] == 3"}},C=function(o,u,d){return[o,u,d]},b=[{path:"",component:(()=>{var o;class u extends l.BasePage{constructor(n,t,r){super(n),this.myHttpService=n,this.utilService=t,this.alertController=r,this.columns=[{name:"De quien",prop:"dequien",type:"text"},{name:"importe",prop:"importe",type:"number"},{name:"P.",prop:"estadoid",type:"action",icon:"swap-horizontal",filterInit:'  ux."estadoid"<>3 ',action:"updatePendiente",OrderInit:"ASC"},{name:"F",prop:"fecha",type:"date",OrderInit:"ASC"}],this.NoCerrados=!0,this.entityName="userxbizum"}ngOnInit(){return(0,c.Z)(function*(){})()}NoCerradosEvent(n){let t=this.columns.find(r=>"estadoid"==r.prop);t&&(t.filterInit=this.NoCerrados?"":' ux."estadoid"<>3',this.getTableRefresh())}actionEmiter(n){var t=this;return(0,c.Z)(function*(){var a;"updatePendiente"===(null==n?void 0:n.action)&&(yield(yield t.alertController.create({header:"Antenci\xf3n!! se va a confirmar el bizum. \xbfContinuar?",buttons:[{text:"Cancelar",role:"cancel",handler:()=>{}},{text:"OK",role:"confirm",handler:(a=(0,c.Z)(function*(){t.updatePendiente(n.row)}),function(){return a.apply(this,arguments)})}]})).present())})()}updatePendiente(n){var t=this;return(0,c.Z)(function*(){try{t.isLoading=!0;const a=new l.classHttp("put",t.entityName,null,"Confirmar",{estadoid:1==n.estadoid?2:1},n.id);(yield t.myHttpService.ejecuteURL(a))&&(t.utilService.message(l.typeMessage.success,"Guardado correctamente"),t.getTableRefresh())}catch{}})()}cerrarEvent(){var n=this;return(0,c.Z)(function*(){var r;yield(yield n.alertController.create({header:`Antenci\xf3n!! se van a cerrar todos los bizum confirmados (${n.TotalImporte} \u20ac). \xbfContinuar?`,buttons:[{text:"Cancelar",role:"cancel",handler:(r=(0,c.Z)(function*(){}),function(){return r.apply(this,arguments)})},{text:"OK",role:"confirm",handler:function(){var r=(0,c.Z)(function*(){yield n.cerrarAll()});return function(){return r.apply(this,arguments)}}()}]})).present()})()}cerrarAll(){var n=this;return(0,c.Z)(function*(){try{const t=new l.classHttp("put",n.entityName,null,"cerrarAll",{});(yield n.myHttpService.ejecuteURL(t))&&(n.utilService.message(l.typeMessage.success,"Guardado correctamente"),n.getTableRefresh())}catch{}})()}onLoadDataEmiter(n){let t=n.filter(r=>2==r.estadoid);t=t.map(r=>r.importe),this.TotalImporte=t.reduce((r,a)=>r+Number(a),0)}}return(o=u).\u0275fac=function(n){return new(n||o)(e.Y36(l.MyHttpService),e.Y36(l.UtilService),e.Y36(i.Br))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-bizum"]],features:[e.qOj],decls:19,vars:17,consts:[[3,"enableOnOffLabels","ngModel","ngModelChange","click"],["color","danger",3,"click"],["slot","start","name","star"],["slot","start"],[3,"title","entityName","columns","withCache","refresh","objNgClass","isLoading","actionEmiter","onLoadDataEmiter"]],template:function(n,t){1&n&&(e.TgZ(0,"ion-grid")(1,"ion-row")(2,"ion-col")(3,"ion-toggle",0),e.NdJ("ngModelChange",function(a){return t.NoCerrados=a})("click",function(a){return t.NoCerradosEvent(a)}),e._uU(4,"No cerrados"),e.qZA()(),e.TgZ(5,"ion-col")(6,"ion-button",1),e.NdJ("click",function(){return t.cerrarEvent()}),e._UZ(7,"ion-icon",2),e._uU(8," CERRAR "),e.qZA()()(),e.TgZ(9,"ion-row")(10,"ion-col")(11,"ion-item")(12,"ion-badge",3),e._uU(13),e.qZA(),e.TgZ(14,"ion-label"),e._uU(15,"Total bizum confirmados"),e.qZA()()()(),e.TgZ(16,"ion-row")(17,"ion-col")(18,"my-table",4),e.NdJ("actionEmiter",function(a){return t.actionEmiter(a)})("onLoadDataEmiter",function(a){return t.onLoadDataEmiter(a)}),e.qZA()()()()),2&n&&(e.xp6(3),e.Q6J("enableOnOffLabels",!0)("ngModel",t.NoCerrados),e.xp6(10),e.hij(" ",t.TotalImporte," \u20ac"),e.xp6(5),e.Q6J("title","Bizums")("entityName",t.entityName)("columns",t.columns)("withCache",!0)("refresh",t.tableRefresh)("objNgClass",e.kEZ(13,C,e.DdM(10,h),e.DdM(11,y),e.DdM(12,v)))("isLoading",t.isLoading))},dependencies:[m.JJ,m.On,i.yp,i.YG,i.wI,i.jY,i.gu,i.Ie,i.Q$,i.Nd,i.ho,i.w,l.MyTableComponent]}),u})()}];let P=(()=>{var o;class u{}return(o=u).\u0275fac=function(n){return new(n||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[f.ez,m.u5,m.UX,i.Pc,g.Bz.forChild(b),l.SharedComponentsModule]}),u})()}}]);