"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1642],{1642:($,_,s)=>{s.r(_),s.d(_,{AgendaPageModule:()=>q});var g=s(4755),S=s(9401),d=s(7002),m=s(9915),u=s(5861),v=s(8175),D=s(1699),e=s(2504),C=s(7241),M=s(6014),T=s(3720);const P=["slider"];function A(a,o){if(1&a&&(e.TgZ(0,"ion-select-option",11),e._uU(1),e.qZA()),2&a){const t=o.$implicit;e.s9C("value",null==t?null:t.id),e.xp6(1),e.Oqu(t.cor)}}function E(a,o){if(1&a&&(e.TgZ(0,"ion-select-option",11),e._uU(1),e.qZA()),2&a){const t=o.$implicit;e.s9C("value",t),e.xp6(1),e.Oqu(t)}}function Z(a,o){if(1&a&&(e.TgZ(0,"ion-col"),e._uU(1),e.qZA()),2&a){const t=o.$implicit;e.xp6(1),e.Oqu(t.cor)}}const F=function(a){return{color:a}};function O(a,o){1&a&&e._UZ(0,"ion-icon",17),2&a&&e.Q6J("ngStyle",e.VKq(1,F,o.$implicit))}const Y=function(a,o){return{diasConEnventosSeleccionado:a,diasSinConEnventosSeleccionado:o}};function w(a,o){if(1&a){const t=e.EpF();e.TgZ(0,"ion-col",13),e.NdJ("click",function(){const r=e.CHM(t).$implicit,l=e.oxw(2);return e.KtG(l.selectDay(r))}),e.TgZ(1,"div",14)(2,"div",15),e._uU(3),e.qZA(),e.TgZ(4,"div",15),e.YNc(5,O,1,3,"ion-icon",16),e.qZA()()()}if(2&a){const t=o.$implicit,n=e.oxw(2);e.Q6J("ngClass",e.WLB(3,Y,(null==t?null:t.TotalEnventos)>0&&(null==t?null:t.fecha)&&(null==t?null:t.fecha.getTime())===(null==n.dateSelected?null:n.dateSelected.getTime()),0==(null==t?null:t.TotalEnventos)&&(null==t?null:t.fecha)&&(null==t?null:t.fecha.getTime())===(null==n.dateSelected?null:n.dateSelected.getTime()))),e.xp6(3),e.hij(" ",null==t?null:t.dia," "),e.xp6(2),e.Q6J("ngForOf",t.lstTiposEvents)}}function x(a,o){if(1&a&&(e.TgZ(0,"ion-row"),e.YNc(1,w,6,6,"ion-col",12),e.qZA()),2&a){const t=o.$implicit;e.xp6(1),e.Q6J("ngForOf",t)}}let N=(()=>{class a{set eventSource(t){this.setEventosInCalendar(t)}constructor(t,n){this.languageService=t,this.utilService=n,this.slideOpts={initialSlide:1,speed:400},this.refreshEnvents=new e.vpe,this.SelectedDate=new e.vpe,this.dateSelected=null,this.dateParaMontarCalendar=new Date((new Date).getFullYear(),(new Date).getMonth(),(new Date).getDate()),this.today=new Date((new Date).getFullYear(),(new Date).getMonth(),(new Date).getDate()),this.months=[],this.Years=[],this.currentMonth=(new Date).getMonth(),this.currentYear=(new Date).getFullYear(),this.lstDiasMesinWeek=[]}ngOnInit(){this.setlanguaje(),this.Setyears(),this.getDiasMes(),this.TodayDesc=this.languageService.today[this.lan].des}changeDate(t,n){"month"==n?"add"==t?this.dateParaMontarCalendar.setMonth(this.dateParaMontarCalendar.getMonth()+1):"sub"==t&&this.dateParaMontarCalendar.setMonth(this.dateParaMontarCalendar.getMonth()-1):"year"==n&&("add"==t?this.dateParaMontarCalendar.setFullYear(this.dateParaMontarCalendar.getFullYear()+1):"sub"==t&&this.dateParaMontarCalendar.setFullYear(this.dateParaMontarCalendar.getFullYear()-1)),this.currentMonth=this.dateParaMontarCalendar.getMonth(),this.currentYear=this.dateParaMontarCalendar.getFullYear(),this.dateSelected=null,this.SelectedDate.emit(this.dateSelected),this.refreshEnvents.emit(this.dateParaMontarCalendar),this.getDiasMes()}setEventosInCalendar(t){t&&this.lstDiasMesinWeek.forEach(n=>{n.forEach(i=>{if(i.fecha){const r=t.filter(l=>this.utilService.getYearFromISO(l.fecha)==this.utilService.getYearFromISO(this.utilService.toISOString(i.fecha)));i.TotalEnventos=r.length,i.lstTiposEvents=[...new Set(r.map(l=>l.color))],i.eventsInDay=r,this.dateSelected&&this.utilService.getYearFromISO(this.utilService.toISOString(i.fecha))==this.utilService.getYearFromISO(this.utilService.toISOString(this.dateSelected))&&this.SelectedDate.emit(i)}})})}Setyears(){this.Years=[];for(var t=1930;t<(new Date).getFullYear()+10;t++)this.Years.push(t)}selectChangedMonth(t){this.currentMonth=parseInt(t.detail.value),this.dateParaMontarCalendar.setMonth(this.currentMonth),this.dateSelected&&this.currentMonth!=this.dateSelected.getMonth()&&(this.dateSelected=null),this.refreshEnvents.emit(this.dateParaMontarCalendar),this.getDiasMes()}selectChangedYear(t){this.currentYear=parseInt(t.detail.value),this.dateParaMontarCalendar.setFullYear(this.currentYear),this.currentYear!=this.dateSelected.getFullYear()&&(this.dateSelected=null),this.refreshEnvents.emit(this.dateParaMontarCalendar),this.getDiasMes()}setlanguaje(){this.months=this.languageService.MonthsName[this.lan],this.days=this.languageService.daysName[this.lan]}padWithZero(t,n){return String(t).padStart(n,"0")}FormatShortDate(t){return t?`${this.padWithZero(t.getDate(),2)}/${this.padWithZero(t.getMonth()+1,2)}/${t.getFullYear()}`:"-"}getDiasMes(){var t=[];this.lstDiasMesinWeek=[];let n=this.dateParaMontarCalendar.getFullYear(),i=this.dateParaMontarCalendar.getMonth()+1,r=new Date(n,i,0).getDate();var l=new Date(n,i-1,1).getDay();if("EN"===this.lan)for(var c=1;c<=l;c++)t.push({dia:h,indice:c});else if(0==l)for(c=1;c<=6;c++)t.push({dia:h,indice:c});else for(c=1;c<l;c++)t.push({dia:h,indice:c});for(var h=1;h<=r;h++){var y=new Date(n,i-1,h);c=y.getDay(),t.push({fecha:y,dia:h,indice:c,TotalEnventos:0})}for(var p=[],f=1;f<=t.length;f++)p.push(t[f-1]),f%7==0&&(this.lstDiasMesinWeek.push(p),p=[]);if(p.length>0){for(f=p.length;f<7;f++)p.push({});this.lstDiasMesinWeek.push(p)}}selectDay(t){this.dateSelected=t&&t.fecha?t.fecha:this.dateSelected,this.SelectedDate.emit(t)}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(T.T),e.Y36(C.f))},a.\u0275cmp=e.Xpm({type:a,selectors:[["aure-date"]],viewQuery:function(t,n){if(1&t&&e.Gf(P,5),2&t){let i;e.iGM(i=e.CRH())&&(n.slider=i.first)}},inputs:{isLoading:"isLoading",lan:"lan",eventSource:"eventSource"},outputs:{refreshEnvents:"refreshEnvents",SelectedDate:"SelectedDate"},decls:17,vars:9,consts:[[1,"fondo-calendar",3,"ngClass"],[1,"CabeceraDetalle"],[1,"container"],[1,"selectDate"],["interface","popover","placeholder","Mes",3,"value","ionChange"],[3,"value",4,"ngFor","ngForOf"],["interface","popover","placeholder","A\xf1o",3,"value","ionChange"],[1,"hand",3,"click"],["name","chevron-back-outline"],["name","chevron-forward-outline"],[4,"ngFor","ngForOf"],[3,"value"],["style","text-align: left;",3,"ngClass","click",4,"ngFor","ngForOf"],[2,"text-align","left",3,"ngClass","click"],[2,"height","20px","text-align","center"],[2,"position","absolute","z-index","0"],["style","font-size: 8px","name","ellipse",3,"ngStyle",4,"ngFor","ngForOf"],["name","ellipse",2,"font-size","8px",3,"ngStyle"]],template:function(t,n){1&t&&(e.TgZ(0,"ion-grid",0)(1,"ion-row",1)(2,"ion-col")(3,"div",2)(4,"div",3)(5,"ion-select",4),e.NdJ("ionChange",function(r){return n.selectChangedMonth(r)}),e.YNc(6,A,2,2,"ion-select-option",5),e.qZA(),e.TgZ(7,"ion-select",6),e.NdJ("ionChange",function(r){return n.selectChangedYear(r)}),e.YNc(8,E,2,2,"ion-select-option",5),e.qZA()(),e.TgZ(9,"div")(10,"ion-col",7),e.NdJ("click",function(){return n.changeDate("sub","month")}),e._UZ(11,"ion-icon",8),e.qZA(),e.TgZ(12,"ion-col",7),e.NdJ("click",function(){return n.changeDate("add","month")}),e._UZ(13,"ion-icon",9),e.qZA()()()()(),e.TgZ(14,"ion-row"),e.YNc(15,Z,2,1,"ion-col",10),e.qZA(),e.YNc(16,x,2,1,"ion-row",10),e.qZA()),2&t&&(e.ekj("disabled",n.isLoading),e.Q6J("ngClass",n.isLoading?"fondo-calendar-disabled":"fondo-calendar"),e.xp6(5),e.s9C("value",n.currentMonth),e.xp6(1),e.Q6J("ngForOf",n.months),e.xp6(1),e.s9C("value",n.currentYear),e.xp6(1),e.Q6J("ngForOf",n.Years),e.xp6(7),e.Q6J("ngForOf",n.days),e.xp6(1),e.Q6J("ngForOf",n.lstDiasMesinWeek))},dependencies:[g.mk,g.sg,g.PC,d.wI,d.jY,d.gu,d.Nd,d.t9,d.n0,d.QI],styles:[".container[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between}.selectDate[_ngcontent-%COMP%]{display:flex;flex-direction:row}.fondo-calendar[_ngcontent-%COMP%]{background-color:#fff;color:#000}.fondo-calendar-disabled[_ngcontent-%COMP%]{color:#fff}.CabeceraDetalle[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;vertical-align:center}.cabeceraNameDay[_ngcontent-%COMP%]{background-color:#848484}.ColCabeceraIconNav[_ngcontent-%COMP%]{display:flex;font-size:13px;align-items:center;cursor:pointer}.CabeceraIconNav[_ngcontent-%COMP%]{background-color:#a9a9a9}.cabecera[_ngcontent-%COMP%], .dias[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.detalleDay[_ngcontent-%COMP%]{font-size:10px}.diaActual[_ngcontent-%COMP%]{font-weight:700;color:#0b3b0b}.diasConEnventos[_ngcontent-%COMP%]{color:#000;background-color:#6e6e6e;color:#fff}.Sub_Sup[_ngcontent-%COMP%]{font-size:8px}.diasConEnventosSeleccionado[_ngcontent-%COMP%]{background-color:#bdbdbd;color:#000}.diasSinConEnventosSeleccionado[_ngcontent-%COMP%]{background-color:#bdbdbd;color:#fff}"]}),a})();var b=s(3380);function I(a,o){if(1&a){const t=e.EpF();e.TgZ(0,"div")(1,"app-editor-entity",3),e.NdJ("saveEvent",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.save(i))})("deleteEvent",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.borrar(i))})("cancelEvent",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.cancelToolEntity())}),e.qZA()()}if(2&a){const t=e.oxw();e.xp6(1),e.Q6J("entity",t.entitySelected)("setEntity",t.entityDescripcion)("isSaving",t.isSaving)("isDeleting",t.isDeleting)}}const J=function(a){return{color:a,"text-transform":"uppercase"}};function k(a,o){if(1&a){const t=e.EpF();e.TgZ(0,"ion-card",5),e.NdJ("click",function(){const r=e.CHM(t).$implicit,l=e.oxw(2);return e.KtG(l.updateEvent(r))}),e.TgZ(1,"ion-card-title")(2,"span",6),e._uU(3),e.qZA()(),e.TgZ(4,"ion-card-content"),e._uU(5),e.qZA()()}if(2&a){const t=o.$implicit;e.xp6(2),e.Q6J("ngStyle",e.VKq(3,J,t.color)),e.xp6(1),e.Oqu(t.descripcion),e.xp6(2),e.hij(" ",t.observacion," ")}}function L(a,o){if(1&a&&(e.TgZ(0,"div"),e.YNc(1,k,6,5,"ion-card",4),e.qZA()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.eventInDay)}}const Q=[{path:"",component:(()=>{class a{constructor(t,n){this.utilService=t,this.myHttpService=n,this.highlightedDates=[],this.entityName="agenda"}ngOnInit(){var t=this;return(0,u.Z)(function*(){yield t.loadList(),t.TodayDate=new Date((new Date).getFullYear(),(new Date).getMonth(),(new Date).getDate())})()}loadList(){var t=this;return(0,u.Z)(function*(){let n=new v.a("get","gestion-casa","agenda");t.isLoading=!0,t.highlightedDates=[];const r=yield t.myHttpService.ejecuteURL(n);r&&(t.highlightedDates=r,t.isLoading=!1)})()}ionChange(t){return(0,u.Z)(function*(){})()}refreshEnvents(t){var n=this;return(0,u.Z)(function*(){yield n.loadList()})()}SelectedDate(t){var n=this;return(0,u.Z)(function*(){n.eventInDay=null==t?void 0:t.eventsInDay,n.selectedDay=null==t?void 0:t.fecha})()}addToolEntity(){const t=this.utilService.toISOString(this.selectedDay?this.selectedDay:new Date);this.entitySelected={fecha:t},this.entityDescripcion=D.Z.giveMeEntity(this.entityName)}cancelToolEntity(){this.entityDescripcion=null}updateEvent(t){this.entitySelected=t,this.entityDescripcion=D.Z.giveMeEntity(this.entityName)}save(t){var n=this;return(0,u.Z)(function*(){n.isSaving=!0;const i=t.id?"put":"post",r=t.id?t.id.toString():null,l=new v.a(i,"gestion-casa","agenda",null,t,r);yield n.myHttpService.ejecuteURL(l),n.entityDescripcion=null,n.isSaving=!1,n.loadList()})()}borrar(t){var n=this;return(0,u.Z)(function*(){n.isDeleting=!0;const r=t.id.toString(),l=new v.a("delete","gestion-casa","agenda",null,null,r);yield n.myHttpService.ejecuteURL(l),n.entityDescripcion=null,n.isDeleting=!1,n.loadList()})()}cancel(){}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(C.f),e.Y36(v.y))},a.\u0275cmp=e.Xpm({type:a,selectors:[["agenda-casa"]],decls:4,vars:7,consts:[[3,"isLoading","entityDescripcion","addToolEntity","cancelToolEntity"],[4,"ngIf"],[3,"isLoading","lan","eventSource","refreshEnvents","SelectedDate"],[3,"entity","setEntity","isSaving","isDeleting","saveEvent","deleteEvent","cancelEvent"],["class","hand",3,"click",4,"ngFor","ngForOf"],[1,"hand",3,"click"],[3,"ngStyle"]],template:function(t,n){1&t&&(e.TgZ(0,"app-tool-entity",0),e.NdJ("addToolEntity",function(){return n.addToolEntity()})("cancelToolEntity",function(){return n.cancelToolEntity()}),e.qZA(),e.YNc(1,I,2,4,"div",1),e.TgZ(2,"aure-date",2),e.NdJ("refreshEnvents",function(r){return n.refreshEnvents(r)})("SelectedDate",function(r){return n.SelectedDate(r)}),e.qZA(),e.YNc(3,L,2,1,"div",1)),2&t&&(e.Q6J("isLoading",n.isLoading)("entityDescripcion",n.entityDescripcion),e.xp6(1),e.Q6J("ngIf",n.entityDescripcion),e.xp6(1),e.Q6J("isLoading",n.isLoading)("lan","ES")("eventSource",n.highlightedDates),e.xp6(1),e.Q6J("ngIf",n.eventInDay))},dependencies:[g.sg,g.O5,g.PC,d.PM,d.FN,d.Dq,M.G,N,b.d]}),a})()}];let j=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[m.Bz.forChild(Q),m.Bz]}),a})();var H=s(7147);let q=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[g.ez,S.u5,d.Pc,j,H.q]}),a})()}}]);