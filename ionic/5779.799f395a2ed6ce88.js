"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5779],{5779:(R,m,l)=>{l.r(m),l.d(m,{GastosPageModule:()=>I});var g=l(4755),d=l(9401),c=l(7002),x=l(7147),h=l(9915),_=l(5861),y=l(1699),f=l(8175),C=l(5916),b=l(6575),t=l(2504),w=l(7241),M=l(5591),v=l(6014),P=l(3380);class O{constructor(){this.count=0,this.limit=0,this.offset=0,this.pageSize=0}}var u=l(2340);function Z(i,s){1&i&&t._UZ(0,"ion-icon",21)}function F(i,s){1&i&&t._UZ(0,"ion-icon",22)}function S(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"ion-col",16)(1,"span",17),t.NdJ("click",function(){const a=t.CHM(e).$implicit,r=t.oxw();return t.KtG(r.setOrder(a))}),t._uU(2),t.qZA(),t._UZ(3,"ion-icon"),t.YNc(4,Z,1,0,"ion-icon",18),t.YNc(5,F,1,0,"ion-icon",19),t._UZ(6,"ion-icon"),t.TgZ(7,"ion-icon",20),t.NdJ("click",function(){const a=t.CHM(e).$implicit,r=t.oxw();return t.KtG(r.setFilter(a))}),t.qZA()()}if(2&i){const e=s.$implicit;t.xp6(2),t.Oqu(e.name),t.xp6(2),t.Q6J("ngIf","asc"==e.order),t.xp6(1),t.Q6J("ngIf","desc"==e.order)}}function k(i,s){1&i&&(t.TgZ(0,"ion-row")(1,"ion-col"),t._UZ(2,"ion-spinner",23),t.qZA()())}function A(i,s){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"span",29),t.NdJ("click",function(){t.CHM(e);const o=t.oxw().$implicit,a=t.oxw().$implicit,r=t.oxw();return t.KtG(r.alert(a[o.prop+"_title"]))}),t._uU(2),t.qZA(),t.BQk()}if(2&i){const e=t.oxw().$implicit,n=t.oxw().$implicit;t.xp6(1),t.s9C("title",n[e.prop+"_title"]),t.xp6(1),t.Oqu(n[e.prop])}}function G(i,s){if(1&i&&(t.ynx(0),t.TgZ(1,"span"),t._uU(2),t.qZA(),t.BQk()),2&i){const e=t.oxw().$implicit,n=t.oxw().$implicit;t.xp6(2),t.Oqu(n[e.prop])}}function E(i,s){if(1&i&&(t.TgZ(0,"ion-col"),t.ynx(1,26),t.YNc(2,A,3,2,"ng-container",27),t.YNc(3,G,3,1,"ng-container",28),t.BQk(),t.qZA()),2&i){const e=s.$implicit;t.xp6(1),t.Q6J("ngSwitch",e.type),t.xp6(1),t.Q6J("ngSwitchCase","text")}}function J(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"ion-row",24),t.NdJ("click",function(){const a=t.CHM(e).$implicit,r=t.oxw();return t.KtG(r.onSelect(a))}),t.YNc(1,E,4,2,"ion-col",25),t.qZA()}if(2&i){const e=s.$implicit,n=s.index,o=t.oxw();t.Udp("background-color",n%2?"#C8E5F8":"white")("font-weight",o.rowSelected==e?"bold":"normal"),t.xp6(1),t.Q6J("ngForOf",o.columns)}}function N(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"ion-col",30)(1,"span",17),t.NdJ("click",function(){const a=t.CHM(e).$implicit,r=t.oxw();return t.KtG(r.onPagination(a))}),t._uU(2),t.qZA()()}if(2&i){const e=s.$implicit,n=t.oxw();t.ekj("page_actual",n.pageActual===e),t.xp6(2),t.Oqu(e)}}function j(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",31)(3,"ion-button",32),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.cancel())}),t._uU(4,"Cancelar"),t.qZA()(),t.TgZ(5,"ion-title"),t._uU(6),t.qZA(),t.TgZ(7,"ion-buttons",33)(8,"ion-button",34),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.confirm())}),t._uU(9,"Filtrar"),t.qZA()()()(),t.TgZ(10,"ion-content",35)(11,"ion-item")(12,"ion-label",36),t._uU(13,"Contiene.."),t.qZA(),t.TgZ(14,"ion-input",37),t.NdJ("ngModelChange",function(o){t.CHM(e);const a=t.oxw();return t.KtG(a.filterText=o)}),t.qZA()()()}if(2&i){const e=t.oxw();t.xp6(6),t.hij("Filtro para ",e.colSelectForFilter.name,""),t.xp6(2),t.Q6J("strong",!0),t.xp6(6),t.Q6J("ngModel",e.filterText)}}let Q=(()=>{class i{set setRow(e){this.rows=this.formatRows(e)}set setTotalFilasConsulta(e){if(e){this.pagination.count=e,this.pagination.count=e,this.numberPagination=Math.trunc(this.pagination.count/this.pagination.limit),this.numberPagination+=this.pagination.count%this.pagination.limit?1:0,this.lstPaginacion=[];for(let n=1;n<=this.numberPagination&&n<6;n++)this.lstPaginacion.push(n)}}constructor(){this.pagination=new O,this.consulting=new t.vpe,this.selecting=new t.vpe,this.rowSelected=null,this.isLoading=!1,this.title="",this.columns=[],this.rows=[],this.isModalOpen=!1,this.filterText="",this.lstPaginacion=[],this.pageActual=1}ngOnInit(){this.pagination.offset=0,this.pagination.pageSize=u.N.pageSize,this.pagination.limit=u.N.pageSize;const e=this.getObjPagFilterOrder("C");this.consulting.emit(e)}getObjPagFilterOrder(e){return{pagination:this.pagination,columns:this.columns,mode:e}}formatRows(e){return e?(e.forEach(n=>{this.columns.forEach(o=>{n[o.prop]&&"text"==o.type&&(n[`${o.prop}_title`]=n[o.prop],n[o.prop]=n[o.prop].substring(0,5).padEnd(8,"."))})}),e):[]}onPagination(e){if(this.pageActual==e)return;this.pageActual=e;let n=[e];e-1>0&&n.unshift(e-1),e-2>0&&n.unshift(e-2),e+1<=this.numberPagination&&n.push(e+1),e+2<=this.numberPagination&&n.push(e+2);const o=n.length,a=Math.max(...n);for(let p=1;p<=5-o;p++)a+p<=this.numberPagination&&n.push(a+p);const r=Math.min(...n);for(let p=1;p<=5-o;p++)r-p>0&&n.unshift(r-p);this.lstPaginacion=n;const T=this.getObjPagFilterOrder("P");T.pagination.offset=e-1,this.consulting.emit(T)}onSelect(e){this.rowSelected=this.rowSelected==e?null:e,this.selecting.emit(this.rowSelected)}setOrder(e){e.order?"asc"==e.order?e.order="desc":"desc"==e.order&&(e.order=null):e.order="asc";const n=this.getObjPagFilterOrder("P");this.consulting.emit(n)}setFilter(e){this.isModalOpen=!0,this.colSelectForFilter=e}cancel(){this.isModalOpen=!1}confirm(){this.modal.dismiss(this.filterText,"confirm")}onWillDismiss(e){const n=e;if("confirm"===n.detail.role){this.isModalOpen=!1,this.colSelectForFilter.filter=n.detail.data,this.pagination.offset=0,this.pagination.pageSize=u.N.pageSize,this.pagination.limit=u.N.pageSize;const o=this.getObjPagFilterOrder("C");this.consulting.emit(o)}}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["my-table"]],viewQuery:function(e,n){if(1&e&&t.Gf(c.ki,5),2&e){let o;t.iGM(o=t.CRH())&&(n.modal=o.first)}},inputs:{isLoading:"isLoading",title:"title",columns:"columns",setRow:"setRow",setTotalFilasConsulta:"setTotalFilasConsulta"},outputs:{consulting:"consulting",selecting:"selecting"},decls:27,vars:13,consts:[[3,"fixed"],[1,"title"],["size","12"],[1,"cabecera-row"],["class","cabecera-titulo",4,"ngFor","ngForOf"],[4,"ngIf"],["class","dato-row",3,"background-color","font-weight","click",4,"ngFor","ngForOf"],[1,"footer-row"],["size","3",1,"pagination-info"],["name","play-skip-back-outline",1,"hand",3,"click"],["name","chevron-back-outline",1,"hand",3,"click"],["class","number-pagination",3,"page_actual",4,"ngFor","ngForOf"],["name","chevron-forward-outline",1,"hand",3,"click"],[1,"pagination-end"],["name","play-skip-forward-outline",1,"hand",3,"click"],[3,"isOpen","willDismiss"],[1,"cabecera-titulo"],[1,"hand",3,"click"],["class","cabecera-icons","name","arrow-up-outline",4,"ngIf"],["class","cabecera-icons","name","arrow-down-outline",4,"ngIf"],["id","open-modal","name","filter-outline",1,"cabecera-icons","hand",3,"click"],["name","arrow-up-outline",1,"cabecera-icons"],["name","arrow-down-outline",1,"cabecera-icons"],["name","dots"],[1,"dato-row",3,"click"],[4,"ngFor","ngForOf"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[3,"title","click"],[1,"number-pagination"],["slot","start"],[3,"click"],["slot","end"],[3,"strong","click"],[1,"ion-padding"],["position","stacked"],["type","text","placeholder","",3,"ngModel","ngModelChange"]],template:function(e,n){1&e&&(t._uU(0),t.ALo(1,"json"),t.TgZ(2,"ion-grid",0)(3,"ion-row",1)(4,"ion-col",2),t._uU(5),t.qZA()(),t.TgZ(6,"ion-row",3),t.YNc(7,S,8,3,"ion-col",4),t.qZA(),t.YNc(8,k,3,0,"ion-row",5),t.YNc(9,J,2,5,"ion-row",6),t.TgZ(10,"ion-row",7)(11,"ion-col",8)(12,"span"),t._uU(13),t.qZA(),t.TgZ(14,"span"),t._uU(15),t.qZA()(),t.TgZ(16,"ion-col")(17,"ion-icon",9),t.NdJ("click",function(){return n.onPagination(1)}),t.qZA()(),t.TgZ(18,"ion-col")(19,"ion-icon",10),t.NdJ("click",function(){return n.pageActual>1&&n.onPagination(n.pageActual-1)}),t.qZA()(),t.YNc(20,N,3,3,"ion-col",11),t.TgZ(21,"ion-col")(22,"ion-icon",12),t.NdJ("click",function(){return n.pageActual<n.numberPagination&&n.onPagination(n.pageActual+1)}),t.qZA()(),t.TgZ(23,"ion-col",13)(24,"ion-icon",14),t.NdJ("click",function(){return n.onPagination(n.numberPagination)}),t.qZA()()()(),t.TgZ(25,"ion-modal",15),t.NdJ("willDismiss",function(a){return n.onWillDismiss(a)}),t.YNc(26,j,15,3,"ng-template"),t.qZA()),2&e&&(t.hij("",t.lcZ(1,11,n.columns),"\n"),t.xp6(2),t.Q6J("fixed",!0),t.xp6(3),t.Oqu(n.title),t.xp6(2),t.Q6J("ngForOf",n.columns),t.xp6(1),t.Q6J("ngIf",n.isLoading),t.xp6(1),t.Q6J("ngForOf",n.rows),t.xp6(4),t.AsE("",n.rows.length,"/",n.pagination.count," total"),t.xp6(2),t.hij("",n.numberPagination," p\xe1ginas"),t.xp6(5),t.Q6J("ngForOf",n.lstPaginacion),t.xp6(5),t.Q6J("isOpen",n.isModalOpen))},dependencies:[g.sg,g.O5,g.RF,g.n9,g.ED,c.YG,c.Sm,c.wI,c.W2,c.jY,c.Gu,c.gu,c.pK,c.Ie,c.Q$,c.Nd,c.PQ,c.wd,c.sr,c.ki,c.j9,d.JJ,d.On,g.Ts],styles:[".title[_ngcontent-%COMP%]{text-align:center;background-color:#fff;font-size:18px}.cabecera-row[_ngcontent-%COMP%]{display:flex;align-items:center;text-align:left;color:#fff;background-color:#444242;font-weight:700;font-size:14px;height:40px}.dato-row[_ngcontent-%COMP%]{font-size:14px;text-align:left;border:solid 1px rgba(221,218,218,.89)}.footer-row[_ngcontent-%COMP%]{display:flex;align-items:center;height:40px;border:solid 1px black;padding:3px;margin-top:2px;font-size:10px;background-color:#f5f5f5}ion-icon[_ngcontent-%COMP%]{font-size:14px}.number-pagination[_ngcontent-%COMP%]{font-size:14px;text-align:center}.page_actual[_ngcontent-%COMP%]{background-color:navy;color:#fff}.pagination-end[_ngcontent-%COMP%]{display:flex;flex-direction:row}.pagination-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-content:center}.cabecera-icons[_ngcontent-%COMP%]{color:#fff;font-size:20px}.cabecera-titulo[_ngcontent-%COMP%]{display:flex;flex-direction:row}"]}),i})();function z(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"div")(1,"app-editor-entity",3),t.NdJ("saveEvent",function(o){t.CHM(e);const a=t.oxw();return t.KtG(a.save(o))})("deleteEvent",function(o){t.CHM(e);const a=t.oxw();return t.KtG(a.borrar(o))})("cancelEvent",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.cancelToolEntity())}),t.qZA()()}if(2&i){const e=t.oxw();t.xp6(1),t.Q6J("entity",e.entitySelected)("setEntity",e.entityDescripcion)("isSaving",e.isSaving)("isDeleting",e.isDeleting)("isAlta",e.isAlta)}}const D=[{path:"",component:(()=>{class i extends C.t{constructor(e,n,o){super(e),this.myHttpService=e,this.utilService=n,this.seguridadService=o,this.columns=[{name:"Fecha",prop:"fecha_p"},{name:"Tipo",prop:"t.descripcion"},{name:"Importe",prop:"importe"},{name:"Obs",prop:"obs_p",type:"text"}],this.entityName="gasto"}ngOnInit(){var e=this;return(0,_.Z)(function*(){e.user=e.seguridadService.UserGet()})()}setConsulta(e){var n=this;return(0,_.Z)(function*(){n.objPagFilterOrder=e,yield n.setPage(e)})()}setPage(e){var n=this;return(0,_.Z)(function*(){n.objPagFilterOrder=e,n.myHttpService.objPagFilterOrder=e;const o=new f.a("get",n.app,n.entityName);n.isLoading=!0,n.lstPrincipal=[];const a=yield n.myHttpService.ejecuteURL(o);n.lstPrincipal=a.data,n.TotalFilasConsulta=a.count,yield n.ownloadList(),n.isLoading=!1})()}addToolEntity(){this.addToolEntityBase();const e=this.utilService.toISOString(new Date);this.entitySelected={fecha:e},this.entityDescripcion=y.Z.giveMeEntity(this.entityName)}selectItem(e){var n=this;return(0,_.Z)(function*(){if(!e)return n.entityDescripcion=null,void(n.entitySelected=null);n.selectItemBase(),"servicio"!=e.descripcion||n.user.role==b.u.GOD?(n.entitySelected=e,n.entityDescripcion=y.Z.giveMeEntity(n.entityName)):yield n.utilService.alert("Los gastos de tipo servicios no se pueden modificar/borrar")})()}save(e){var n=this;return(0,_.Z)(function*(){n.isSaving=!0;const o=n.isAlta?"post":"put",a=n.isAlta?null:e[n.pk].toString(),r=new f.a(o,n.app,n.entityName,null,e,a);yield n.myHttpService.ejecuteURL(r),n.entityDescripcion=null,n.isSaving=!1,n.setPage(n.objPagFilterOrder)})()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(f.y),t.Y36(w.f),t.Y36(M.F))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-gastos"]],features:[t.qOj],decls:3,vars:8,consts:[[3,"isLoading","entityDescripcion","addToolEntity","cancelToolEntity"],[4,"ngIf"],[3,"isLoading","title","columns","setRow","setTotalFilasConsulta","consulting","paging","selecting"],[3,"entity","setEntity","isSaving","isDeleting","isAlta","saveEvent","deleteEvent","cancelEvent"]],template:function(e,n){1&e&&(t.TgZ(0,"app-tool-entity",0),t.NdJ("addToolEntity",function(){return n.addToolEntity()})("cancelToolEntity",function(){return n.cancelToolEntity()}),t.qZA(),t.YNc(1,z,2,5,"div",1),t.TgZ(2,"my-table",2),t.NdJ("consulting",function(a){return n.setConsulta(a)})("paging",function(a){return n.setPage(a)})("selecting",function(a){return n.selectItem(a)}),t.qZA()),2&e&&(t.Q6J("isLoading",n.isLoading)("entityDescripcion",n.entityDescripcion),t.xp6(1),t.Q6J("ngIf",n.entityDescripcion),t.xp6(1),t.Q6J("isLoading",n.isLoading)("title","Gastos")("columns",n.columns)("setRow",n.lstPrincipal)("setTotalFilasConsulta",n.TotalFilasConsulta))},dependencies:[g.O5,v.G,P.d,Q],styles:[".tableTitle[_ngcontent-%COMP%]{text-align:center;color:#fff;background-color:#444242;font-weight:700;font-size:14px}.tableRow[_ngcontent-%COMP%]{text-align:center;font-size:13px;border:1px solid;cursor:pointer;color:#000;background-color:#fff}.tableRow_pendientecobro[_ngcontent-%COMP%]{border:solid 1px red}.tableRowSeleded[_ngcontent-%COMP%]{text-align:center;color:#fff;background-color:#00008b;cursor:pointer}.tableRow[_ngcontent-%COMP%]:hover{color:#fff;background-color:#00008b}"]}),i})()}];let U=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[h.Bz.forChild(D),h.Bz]}),i})(),I=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[g.ez,d.u5,c.Pc,U,x.q]}),i})()}}]);