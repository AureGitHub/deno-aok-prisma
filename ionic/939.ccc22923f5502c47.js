"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[939],{939:(Z,p,c)=>{c.r(p),c.d(p,{UsersPagePageModule:()=>E});var m=c(6814),a=c(95),i=c(2511),g=c(5861),d=c(242),e=c(6689),v=c(5875);function h(s,r){if(1&s){const o=e.EpF();e.TgZ(0,"ion-card",1)(1,"ion-card-header")(2,"ion-card-title"),e._uU(3),e.qZA(),e.TgZ(4,"ion-card-subtitle"),e._uU(5),e.ALo(6,"number"),e.qZA()(),e.TgZ(7,"ion-card-content")(8,"form",2)(9,"ion-list")(10,"ion-item")(11,"h2"),e._uU(12,"Incrementar saldo"),e.qZA()(),e.TgZ(13,"ion-item"),e._UZ(14,"ion-input",3),e.qZA(),e.TgZ(15,"ion-item"),e._UZ(16,"br"),e.TgZ(17,"base-button-guardar",4),e.NdJ("click",function(){e.CHM(o);const t=e.oxw();return e.KtG(t.onSubmit())}),e.qZA()()()()(),e._UZ(18,"br")(19,"br"),e.TgZ(20,"base-button-cancelar",5),e.NdJ("click",function(){e.CHM(o);const t=e.oxw();return e.KtG(t.cancel())}),e.qZA()()}if(2&s){const o=e.oxw();e.s9C("color",(null==o.user?null:o.user.saldo)<1?"danger":(null==o.user?null:o.user.saldo)>1&&(null==o.user?null:o.user.saldo)<2?"warning":"primary"),e.xp6(3),e.Oqu(null==o.user?null:o.user.name),e.xp6(2),e.hij("Saldo actual : ",e.lcZ(6,6,null==o.user?null:o.user.saldo),""),e.xp6(3),e.Q6J("formGroup",o.formGroup),e.xp6(9),e.Q6J("isSaving",o.isSaving)("valid",o.formGroup.valid)}}let _=(()=>{var s;class r{set SetUser(n){n&&(this.user=n,this.createForm())}constructor(n,t){this.myHttpService=n,this.utilService=t,this.saveEvent=new e.vpe,this.cancelEvent=new e.vpe,this.isSaving=!1}ngOnInit(){}createForm(){var n;this.formGroup=new a.cw({id:new a.NI("",[a.kI.required]),importe:new a.NI("",[a.kI.required])}),this.formGroup.controls.id.setValue(null===(n=this.user)||void 0===n?void 0:n.id)}onSubmit(){var n=this;return(0,g.Z)(function*(){n.isSaving=!0;try{const t=new d.classHttp("post","user",null,"addSaldo",n.formGroup.value),l=yield n.myHttpService.ejecuteURL(t);n.isSaving=!1,l&&(n.utilService.message(d.typeMessage.success,"Guardado correctamente"),n.user=null,n.saveEvent.emit(!0))}catch{n.isSaving=!1}})()}cancel(){this.user=null,this.cancelEvent.emit(!0)}}return(s=r).\u0275fac=function(n){return new(n||s)(e.Y36(d.MyHttpService),e.Y36(d.UtilService))},s.\u0275cmp=e.Xpm({type:s,selectors:[["add-saldo"]],inputs:{SetUser:"SetUser"},outputs:{saveEvent:"saveEvent",cancelEvent:"cancelEvent"},decls:2,vars:1,consts:[[3,"isOpen","willDismiss"],[3,"color"],[3,"formGroup"],["label","importe","formControlName","importe","type","number","placeholder","000"],[3,"isSaving","valid","click"],[3,"click"]],template:function(n,t){1&n&&(e.TgZ(0,"ion-modal",0),e.NdJ("willDismiss",function(){return t.cancel()}),e.YNc(1,h,21,8,"ng-template"),e.qZA()),2&n&&e.Q6J("isOpen",null!=t.user)},dependencies:[i.PM,i.FN,i.Zi,i.tO,i.Dq,i.pK,i.Ie,i.q_,i.ki,i.as,a._Y,a.JJ,a.JL,a.sg,a.u,d.ButtonGuardarComponent,d.ButtonCancelarComponent,m.JJ],styles:["ion-checkbox[_ngcontent-%COMP%]{--size: 32px;--checkbox-background-checked: #6815ec}ion-checkbox[_ngcontent-%COMP%]::part(container){border-radius:6px;border:2px solid #6815ec}"]}),r})();function f(s,r){if(1&s&&(e.TgZ(0,"ion-select-option",6),e._uU(1),e.qZA()),2&s){const o=r.$implicit;e.Q6J("value",o.id),e.xp6(1),e.hij(" ",o.name," ")}}const S=function(){return{class:"enRojo",condicion:"row['saldo'] <1"}},A=function(){return{class:"enNaranja",condicion:"row['saldo'] >= 1 && row['saldo'] < 2"}},U=function(s,r){return[s,r]};let b=(()=>{var s;class r extends d.BasePage{constructor(n,t){super(n,t),this.myHttpService=n,this.seguridadService=t,this.lstUser=[],this.userIdSelected=-1,this.columns=[],this.soloActivos=!0,this.entityName="User"}ngOnInit(){var n=this;return(0,g.Z)(function*(){n.Init(),n.lstUser=yield n.getUsers(),n.columns=[{name:"Nombre",prop:"name",type:"text"},{name:"Saldo",prop:"saldo",type:"number",OrderInit:"ASC"},{name:"estado",prop:"estadoid",type:"number",filterInit:' "estadoid" <> 2',hide:!0},{name:"Bizum",prop:"",type:"action",icon:"card",action:"addBizum",canAction:n.user.isAdmin},{name:"Saldo",prop:"",type:"action",icon:"logo-euro",action:"addSaldo",canAction:n.user.isAdmin}]})()}selectUserEvent(){this.columns=[{name:"Nombre",prop:"name",type:"text",filterInit:-1==this.userIdSelected?"":` id = ${this.userIdSelected}  `},{name:"Saldo",prop:"saldo",type:"number",OrderInit:"ASC"},{name:"estado",prop:"estadoid",type:"number",filterInit:' "estadoid" <> 2',hide:!0},{name:"Bizum",prop:"",type:"action",icon:"card",action:"addBizum",canAction:this.user.isAdmin},{name:"Saldo",prop:"",type:"action",icon:"logo-euro",action:"addSaldo",canAction:this.user.isAdmin}],this.getTableRefresh()}soloActivoEvent(n){let t=this.columns.find(l=>"estado"==l.name);t&&(t.filterInit=this.soloActivos?"":' "estadoid" <> 2',this.getTableRefresh())}actionEmiter(n){switch(null==n?void 0:n.action){case"addBizum":this.rowAddBizum=n.row;break;case"addSaldo":this.rowAddSaldo=n.row}}}return(s=r).\u0275fac=function(n){return new(n||s)(e.Y36(d.MyHttpService),e.Y36(d.SeguridadService))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-users"]],features:[e.qOj],decls:14,vars:19,consts:[["justify","start",3,"ngModel","ngModelChange","click"],["interface","popover",3,"ngModel","ngModelChange","ionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"canAddEntity","canUpdateEntity","title","entityName","columns","withCache","refresh","objNgClass","actionEmiter"],[3,"SetUser","saveEvent","cancelEvent"],[3,"SetUser","fromAdmin","saveEvent","cancelEvent"],[3,"value"]],template:function(n,t){1&n&&(e.TgZ(0,"ion-grid")(1,"ion-row")(2,"ion-col")(3,"ion-checkbox",0),e.NdJ("ngModelChange",function(u){return t.soloActivos=u})("click",function(u){return t.soloActivoEvent(u)}),e._uU(4,"Solo activos"),e.qZA()()(),e.TgZ(5,"ion-row")(6,"ion-col")(7,"ion-select",1),e.NdJ("ngModelChange",function(u){return t.userIdSelected=u})("ionChange",function(){return t.selectUserEvent()}),e.YNc(8,f,2,2,"ion-select-option",2),e.qZA()()(),e.TgZ(9,"ion-row")(10,"ion-col")(11,"my-table",3),e.NdJ("actionEmiter",function(u){return t.actionEmiter(u)}),e.qZA()()()(),e.TgZ(12,"add-saldo",4),e.NdJ("saveEvent",function(){return t.getTableRefresh()})("cancelEvent",function(){return t.rowAddSaldo=null}),e.qZA(),e.TgZ(13,"add-bizum",5),e.NdJ("saveEvent",function(){return t.getTableRefresh()})("cancelEvent",function(){return t.rowAddBizum=null}),e.qZA()),2&n&&(e.xp6(3),e.Q6J("ngModel",t.soloActivos),e.xp6(4),e.Q6J("ngModel",t.userIdSelected),e.xp6(1),e.Q6J("ngForOf",t.lstUser),e.xp6(3),e.Q6J("canAddEntity",t.user.isAdmin)("canUpdateEntity",t.user.isAdmin)("title","Lud\xf3patas")("entityName",t.entityName)("columns",t.columns)("withCache",!0)("refresh",t.tableRefresh)("objNgClass",e.WLB(16,U,e.DdM(14,S),e.DdM(15,A))),e.xp6(1),e.Q6J("SetUser",t.rowAddSaldo),e.xp6(1),e.Q6J("SetUser",t.rowAddBizum)("fromAdmin",!0))},dependencies:[m.sg,a.JJ,a.On,i.nz,i.wI,i.jY,i.Nd,i.t9,i.n0,i.w,i.QI,d.MyTableComponent,v.I,_]}),r})();var y=c(3044),C=c(3355);const T=[{path:"",component:b}];let E=(()=>{var s;class r{}return(s=r).\u0275fac=function(n){return new(n||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[m.ez,a.u5,a.UX,i.Pc,y.Bz.forChild(T),d.SharedComponentsModule,C.S]}),r})()}}]);