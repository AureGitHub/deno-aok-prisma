"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5779],{5779:(R,m,l)=>{l.r(m),l.d(m,{GastosPageModule:()=>H});var g=l(4755),d=l(9401),s=l(7002),x=l(7147),h=l(9915),_=l(5861),y=l(1699),f=l(8175),b=l(1840),w=l(6575),t=l(2504),C=l(7241),M=l(5591),v=l(6014),Z=l(3380);class P{constructor(){this.count=0,this.limit=0,this.offset=0,this.pageSize=0}}var u=l(2340);function O(e,c){1&e&&t._UZ(0,"ion-icon",22)}function F(e,c){1&e&&t._UZ(0,"ion-icon",23)}function k(e,c){if(1&e){const n=t.EpF();t.TgZ(0,"ion-col",15)(1,"span",16),t.NdJ("click",function(){const a=t.CHM(n).$implicit,r=t.oxw();return t.KtG(r.setOrder(a))}),t._uU(2),t.qZA(),t._UZ(3,"div",17),t.TgZ(4,"div",18)(5,"ion-icon",19),t.NdJ("click",function(){const a=t.CHM(n).$implicit,r=t.oxw();return t.KtG(r.setFilter(a))}),t.qZA(),t.YNc(6,O,1,0,"ion-icon",20),t.YNc(7,F,1,0,"ion-icon",21),t._UZ(8,"ion-icon"),t.qZA()()}if(2&e){const n=c.$implicit;t.xp6(1),t.Udp("color",n.filter?"green":"white"),t.xp6(1),t.Oqu(n.name),t.xp6(4),t.Q6J("ngIf","asc"==n.order),t.xp6(1),t.Q6J("ngIf","desc"==n.order)}}function S(e,c){1&e&&(t.TgZ(0,"ion-row")(1,"ion-col"),t._UZ(2,"ion-spinner",24),t.qZA()())}function A(e,c){if(1&e){const n=t.EpF();t.ynx(0),t.TgZ(1,"span",31),t.NdJ("click",function(){t.CHM(n);const o=t.oxw().$implicit,a=t.oxw().$implicit,r=t.oxw();return t.KtG(r.alert(a[o.prop+"_title"]))}),t._uU(2),t.qZA(),t.BQk()}if(2&e){const n=t.oxw().$implicit,i=t.oxw().$implicit;t.xp6(1),t.s9C("title",i[n.prop+"_title"]),t.xp6(1),t.Oqu(i[n.prop])}}function G(e,c){if(1&e&&(t.ynx(0),t.TgZ(1,"div",32),t._uU(2),t.qZA(),t.BQk()),2&e){const n=t.oxw().$implicit,i=t.oxw().$implicit;t.xp6(2),t.Oqu(i[n.prop])}}function N(e,c){if(1&e&&(t.ynx(0),t.TgZ(1,"span"),t._uU(2),t.qZA(),t.BQk()),2&e){const n=t.oxw().$implicit,i=t.oxw().$implicit;t.xp6(2),t.Oqu(i[n.prop])}}function J(e,c){if(1&e&&(t.ynx(0),t.TgZ(1,"span"),t._uU(2),t.qZA(),t.BQk()),2&e){const n=t.oxw().$implicit,i=t.oxw().$implicit;t.xp6(2),t.Oqu(i[n.prop])}}function E(e,c){if(1&e&&(t.TgZ(0,"ion-col",27),t.ynx(1,28),t.YNc(2,A,3,2,"ng-container",29),t.YNc(3,G,3,1,"ng-container",29),t.YNc(4,N,3,1,"ng-container",29),t.YNc(5,J,3,1,"ng-container",30),t.BQk(),t.qZA()),2&e){const n=c.$implicit;t.xp6(1),t.Q6J("ngSwitch",n.type),t.xp6(1),t.Q6J("ngSwitchCase","text"),t.xp6(1),t.Q6J("ngSwitchCase","number"),t.xp6(1),t.Q6J("ngSwitchCase","date")}}function U(e,c){if(1&e){const n=t.EpF();t.TgZ(0,"ion-row",25),t.NdJ("click",function(){const a=t.CHM(n).$implicit,r=t.oxw();return t.KtG(r.onSelect(a))}),t.YNc(1,E,6,4,"ion-col",26),t.qZA()}if(2&e){const n=c.$implicit,i=c.index,o=t.oxw();t.Udp("background-color",i%2?"#C8E5F8":"white")("font-weight",o.rowSelected==n?"bold":"normal"),t.xp6(1),t.Q6J("ngForOf",o.columns)}}function Q(e,c){if(1&e){const n=t.EpF();t.TgZ(0,"ion-col",33)(1,"span",16),t.NdJ("click",function(){const a=t.CHM(n).$implicit,r=t.oxw();return t.KtG(r.onPagination(a))}),t._uU(2),t.qZA()()}if(2&e){const n=c.$implicit,i=t.oxw();t.ekj("page_actual",i.pageActual===n),t.xp6(2),t.Oqu(n)}}function j(e,c){if(1&e){const n=t.EpF();t.TgZ(0,"ion-card")(1,"ion-card-header")(2,"ion-card-title"),t._uU(3),t.qZA()(),t.TgZ(4,"ion-card-content")(5,"ion-item")(6,"ion-label",34),t._uU(7,"Contiene.."),t.qZA(),t.TgZ(8,"ion-input",35),t.NdJ("ngModelChange",function(o){t.CHM(n);const a=t.oxw();return t.KtG(a.filterText=o)}),t.qZA()()(),t.TgZ(9,"ion-button",36),t.NdJ("click",function(){t.CHM(n);const o=t.oxw();return t.KtG(o.cancel())}),t._UZ(10,"ion-icon",37),t._uU(11," Cancelar "),t.qZA(),t.TgZ(12,"ion-button",38),t.NdJ("click",function(){t.CHM(n);const o=t.oxw();return t.KtG(o.borrar())}),t._UZ(13,"ion-icon",37),t._uU(14," Borrar "),t.qZA(),t.TgZ(15,"ion-button",39),t.NdJ("click",function(){t.CHM(n);const o=t.oxw();return t.KtG(o.filtar())}),t._UZ(16,"ion-icon",37),t._uU(17," Filtrar "),t.qZA()()}if(2&e){const n=t.oxw();t.xp6(3),t.hij("Filtro para ",n.colSelectForFilter.name,""),t.xp6(5),t.Q6J("ngModel",n.filterText)}}let q=(()=>{class e{set setRow(n){this.rows=this.formatRows(n)}set setTotalFilasConsulta(n){if(n){this.pagination.count=n,this.pagination.count=n,this.numberPagination=Math.trunc(this.pagination.count/this.pagination.limit),this.numberPagination+=this.pagination.count%this.pagination.limit?1:0,this.lstPaginacion=[];for(let i=1;i<=this.numberPagination&&i<6;i++)this.lstPaginacion.push(i)}}constructor(){this.pagination=new P,this.consulting=new t.vpe,this.selecting=new t.vpe,this.rowSelected=null,this.isLoading=!1,this.title="",this.columns=[],this.rows=[],this.isModalOpen=!1,this.filterText="",this.lstPaginacion=[],this.pageActual=1}ngOnInit(){this.pagination.offset=0,this.pagination.pageSize=u.N.pageSize,this.pagination.limit=u.N.pageSize;const n=this.getObjPagFilterOrder("C");this.consulting.emit(n)}getObjPagFilterOrder(n){return{pagination:this.pagination,columns:this.columns,mode:n}}formatRows(n){return n?(n.forEach(i=>{this.columns.forEach(o=>{i[o.prop]&&"text"==o.type&&(i[`${o.prop}_title`]=i[o.prop],i[o.prop]=i[o.prop].substring(0,5).padEnd(8,"."))})}),n):[]}onPagination(n){if(this.pageActual==n)return;this.pageActual=n;let i=[n];n-1>0&&i.unshift(n-1),n-2>0&&i.unshift(n-2),n+1<=this.numberPagination&&i.push(n+1),n+2<=this.numberPagination&&i.push(n+2);const o=i.length,a=Math.max(...i);for(let p=1;p<=5-o;p++)a+p<=this.numberPagination&&i.push(a+p);const r=Math.min(...i);for(let p=1;p<=5-o;p++)r-p>0&&i.unshift(r-p);this.lstPaginacion=i;const T=this.getObjPagFilterOrder("P");T.pagination.offset=n-1,this.consulting.emit(T)}onSelect(n){this.rowSelected=this.rowSelected==n?null:n,this.selecting.emit(this.rowSelected)}setOrder(n){n.order?"asc"==n.order?n.order="desc":"desc"==n.order&&(n.order=null):n.order="asc";const i=this.getObjPagFilterOrder("P");this.consulting.emit(i)}setFilter(n){this.isModalOpen=!0,this.colSelectForFilter=n,this.filterText=n.filter}cancel(){this.isModalOpen=!1}borrar(){this.isModalOpen=!1,this.colSelectForFilter.filter="",this.buscar()}filtar(){this.isModalOpen=!1,this.colSelectForFilter.filter=this.filterText,this.buscar()}buscar(){this.pagination.offset=0,this.pageActual=1,this.pagination.pageSize=u.N.pageSize,this.pagination.limit=u.N.pageSize;const n=this.getObjPagFilterOrder("C");this.consulting.emit(n)}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["my-table"]],viewQuery:function(n,i){if(1&n&&t.Gf(s.ki,5),2&n){let o;t.iGM(o=t.CRH())&&(i.modal=o.first)}},inputs:{isLoading:"isLoading",title:"title",columns:"columns",setRow:"setRow",setTotalFilasConsulta:"setTotalFilasConsulta"},outputs:{consulting:"consulting",selecting:"selecting"},decls:26,vars:13,consts:[[3,"fixed"],[1,"title"],["size","12"],[1,"cabecera-row"],["class","cabecera-titulo",4,"ngFor","ngForOf"],[4,"ngIf"],["class","dato-row",3,"background-color","font-weight","click",4,"ngFor","ngForOf"],[1,"footer-row"],["size","3",1,"pagination-info"],["name","play-skip-back-outline",1,"hand",3,"click"],["name","chevron-back-outline",1,"hand",3,"click"],["class","number-pagination",3,"page_actual",4,"ngFor","ngForOf"],["name","chevron-forward-outline",1,"hand",3,"click"],[1,"pagination-end"],["name","play-skip-forward-outline",1,"hand",3,"click"],[1,"cabecera-titulo"],[1,"hand",3,"click"],[2,"width","5px"],[1,"cabecera-atributos"],["id","open-modal","name","filter-outline",1,"cabecera-icons","hand",3,"click"],["class","cabecera-icons","name","arrow-up-outline",4,"ngIf"],["class","cabecera-icons","name","arrow-down-outline",4,"ngIf"],["name","arrow-up-outline",1,"cabecera-icons"],["name","arrow-down-outline",1,"cabecera-icons"],["name","dots"],[1,"dato-row",3,"click"],["style","text-align: center;",4,"ngFor","ngForOf"],[2,"text-align","center"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[2,"text-align","left",3,"title","click"],[1,"inline-block",2,"width","100%"],[1,"number-pagination"],["position","stacked"],["type","text","placeholder","",3,"ngModel","ngModelChange"],["color","warning",3,"click"],["slot","start","name","star"],["color","danger",3,"click"],["color","success",3,"click"]],template:function(n,i){1&n&&(t._uU(0),t.ALo(1,"json"),t.TgZ(2,"ion-grid",0)(3,"ion-row",1)(4,"ion-col",2),t._uU(5),t.qZA()(),t.TgZ(6,"ion-row",3),t.YNc(7,k,9,5,"ion-col",4),t.qZA(),t.YNc(8,S,3,0,"ion-row",5),t.YNc(9,U,2,5,"ion-row",6),t.TgZ(10,"ion-row",7)(11,"ion-col",8)(12,"span"),t._uU(13),t.qZA(),t.TgZ(14,"span"),t._uU(15),t.qZA()(),t.TgZ(16,"ion-col")(17,"ion-icon",9),t.NdJ("click",function(){return i.onPagination(1)}),t.qZA()(),t.TgZ(18,"ion-col")(19,"ion-icon",10),t.NdJ("click",function(){return i.pageActual>1&&i.onPagination(i.pageActual-1)}),t.qZA()(),t.YNc(20,Q,3,3,"ion-col",11),t.TgZ(21,"ion-col")(22,"ion-icon",12),t.NdJ("click",function(){return i.pageActual<i.numberPagination&&i.onPagination(i.pageActual+1)}),t.qZA()(),t.TgZ(23,"ion-col",13)(24,"ion-icon",14),t.NdJ("click",function(){return i.onPagination(i.numberPagination)}),t.qZA()()()(),t.YNc(25,j,18,2,"ion-card",5)),2&n&&(t.hij("",t.lcZ(1,11,i.columns),"\n"),t.xp6(2),t.Q6J("fixed",!0),t.xp6(3),t.Oqu(i.title),t.xp6(2),t.Q6J("ngForOf",i.columns),t.xp6(1),t.Q6J("ngIf",i.isLoading),t.xp6(1),t.Q6J("ngForOf",i.rows),t.xp6(4),t.AsE("",i.rows.length,"/",i.pagination.count," total"),t.xp6(2),t.hij("",i.numberPagination," p\xe1ginas"),t.xp6(5),t.Q6J("ngForOf",i.lstPaginacion),t.xp6(5),t.Q6J("ngIf",i.isModalOpen))},dependencies:[g.sg,g.O5,g.RF,g.n9,g.ED,s.YG,s.PM,s.FN,s.Zi,s.Dq,s.wI,s.jY,s.gu,s.pK,s.Ie,s.Q$,s.Nd,s.PQ,s.j9,d.JJ,d.On,g.Ts],styles:[".title[_ngcontent-%COMP%]{text-align:center;background-color:#fff;font-size:18px}.cabecera-row[_ngcontent-%COMP%]{display:flex;align-items:center;text-align:left;color:#fff;background-color:#444242;font-weight:700;font-size:14px;height:40px}.dato-row[_ngcontent-%COMP%]{font-size:14px;text-align:left;border:solid 1px rgba(221,218,218,.89)}.footer-row[_ngcontent-%COMP%]{display:flex;align-items:center;height:40px;border:solid 1px black;padding:3px;margin-top:2px;font-size:10px;background-color:#f5f5f5}.number-pagination[_ngcontent-%COMP%]{font-size:14px;text-align:center}.page_actual[_ngcontent-%COMP%]{background-color:navy;color:#fff}.pagination-end[_ngcontent-%COMP%]{display:flex;flex-direction:row}.pagination-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-content:center}.cabecera-icons[_ngcontent-%COMP%]{color:#fff;font-size:15px}.cabecera-titulo[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;border:1px solid red}.inline-block[_ngcontent-%COMP%]{display:inline-block;text-align:right}"]}),e})();function z(e,c){if(1&e){const n=t.EpF();t.TgZ(0,"div")(1,"app-editor-entity",3),t.NdJ("saveEvent",function(o){t.CHM(n);const a=t.oxw();return t.KtG(a.save(o))})("deleteEvent",function(o){t.CHM(n);const a=t.oxw();return t.KtG(a.borrar(o))})("cancelEvent",function(){t.CHM(n);const o=t.oxw();return t.KtG(o.cancelToolEntity())}),t.qZA()()}if(2&e){const n=t.oxw();t.xp6(1),t.Q6J("entity",n.entitySelected)("setEntity",n.entityDescripcion)("isSaving",n.isSaving)("isDeleting",n.isDeleting)("isAlta",n.isAlta)}}const $=[{path:"",component:(()=>{class e extends b.t{constructor(n,i,o){super(n),this.myHttpService=n,this.utilService=i,this.seguridadService=o,this.columns=[{name:"Fecha",prop:"fecha_p",type:"date"},{name:"Tipo",prop:"t.descripcion",type:"text"},{name:"Importe",prop:"importe",type:"number"},{name:"Obs",prop:"obs_p",type:"text"}],this.entityName="gasto"}ngOnInit(){var n=this;return(0,_.Z)(function*(){n.user=n.seguridadService.UserGet()})()}setConsulta(n){var i=this;return(0,_.Z)(function*(){i.objPagFilterOrder=n,yield i.setPage(n)})()}setPage(n){var i=this;return(0,_.Z)(function*(){i.objPagFilterOrder=n,i.myHttpService.objPagFilterOrder=n;const o=new f.a("get",i.app,i.entityName);i.isLoading=!0,i.lstPrincipal=[];const a=yield i.myHttpService.ejecuteURL(o);i.lstPrincipal=a.data,i.TotalFilasConsulta=a.count,yield i.ownloadList(),i.isLoading=!1})()}addToolEntity(){this.addToolEntityBase();const n=this.utilService.toISOString(new Date);this.entitySelected={fecha:n},this.entityDescripcion=y.Z.giveMeEntity(this.entityName)}selectItem(n){var i=this;return(0,_.Z)(function*(){if(!n)return i.entityDescripcion=null,void(i.entitySelected=null);i.selectItemBase(),"servicio"!=n.descripcion||i.user.role==w.u.GOD?(i.entitySelected=n,i.entityDescripcion=y.Z.giveMeEntity(i.entityName)):yield i.utilService.alert("Los gastos de tipo servicios no se pueden modificar/borrar")})()}save(n){var i=this;return(0,_.Z)(function*(){i.isSaving=!0;const o=i.isAlta?"post":"put",a=i.isAlta?null:n[i.pk].toString(),r=new f.a(o,i.app,i.entityName,null,n,a);yield i.myHttpService.ejecuteURL(r),i.entityDescripcion=null,i.isSaving=!1,i.setPage(i.objPagFilterOrder)})()}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(f.y),t.Y36(C.f),t.Y36(M.F))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-gastos"]],features:[t.qOj],decls:3,vars:8,consts:[[3,"isLoading","entityDescripcion","addToolEntity","cancelToolEntity"],[4,"ngIf"],[3,"isLoading","title","columns","setRow","setTotalFilasConsulta","consulting","paging","selecting"],[3,"entity","setEntity","isSaving","isDeleting","isAlta","saveEvent","deleteEvent","cancelEvent"]],template:function(n,i){1&n&&(t.TgZ(0,"app-tool-entity",0),t.NdJ("addToolEntity",function(){return i.addToolEntity()})("cancelToolEntity",function(){return i.cancelToolEntity()}),t.qZA(),t.YNc(1,z,2,5,"div",1),t.TgZ(2,"my-table",2),t.NdJ("consulting",function(a){return i.setConsulta(a)})("paging",function(a){return i.setPage(a)})("selecting",function(a){return i.selectItem(a)}),t.qZA()),2&n&&(t.Q6J("isLoading",i.isLoading)("entityDescripcion",i.entityDescripcion),t.xp6(1),t.Q6J("ngIf",i.entityDescripcion),t.xp6(1),t.Q6J("isLoading",i.isLoading)("title","Gastos")("columns",i.columns)("setRow",i.lstPrincipal)("setTotalFilasConsulta",i.TotalFilasConsulta))},dependencies:[g.O5,v.G,Z.d,q],styles:[".tableTitle[_ngcontent-%COMP%]{text-align:center;color:#fff;background-color:#444242;font-weight:700;font-size:14px}.tableRow[_ngcontent-%COMP%]{text-align:center;font-size:13px;border:1px solid;cursor:pointer;color:#000;background-color:#fff}.tableRow_pendientecobro[_ngcontent-%COMP%]{border:solid 1px red}.tableRowSeleded[_ngcontent-%COMP%]{text-align:center;color:#fff;background-color:#00008b;cursor:pointer}.tableRow[_ngcontent-%COMP%]:hover{color:#fff;background-color:#00008b}"]}),e})()}];let I=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[h.Bz.forChild($),h.Bz]}),e})(),H=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[g.ez,d.u5,s.Pc,I,x.q]}),e})()}}]);