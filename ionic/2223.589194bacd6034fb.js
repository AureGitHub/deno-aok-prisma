"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2223],{2223:(J,g,r)=>{r.r(g),r.d(g,{TurnosPageModule:()=>Z});var h=r(4755),p=r(9401),s=r(7002),f=r(9915),m=r(5861),u=r(8175),v=r(6575),e=r(2504),P=r(7241),T=r(5591);function y(t,a){if(1&t){const n=e.EpF();e.TgZ(0,"ion-chip",4),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.selectedPerson=null)}),e._uU(1,"Cancelar"),e.qZA()}2&t&&e.Q6J("outline",!0)}function C(t,a){1&t&&(e.TgZ(0,"ion-row")(1,"ion-col"),e._UZ(2,"ion-spinner",5),e.qZA()())}const S=[{path:"",component:(()=>{class t{constructor(n,o,i){this.utilService=n,this.seguridadService=o,this.myHttpService=i,this.WhoHasPermision=[v.u.GOD],this.havePermision=!1,this.aureBackColor="#ffc0cb",this.carmenBackColor="#c8e5d0",this.highlightedDates=[]}ngOnInit(){const n=this.seguridadService.UserGet();this.havePermision=this.WhoHasPermision.some(o=>o==n.role),this.loadList()}loadList(){var n=this;return(0,m.Z)(function*(){let o=new u.a("get","gestion-casa","turnos");n.isLoading=!0,n.highlightedDates=[];const i=[],l=yield n.myHttpService.ejecuteURL(o);l&&(l.forEach(c=>{i.push({date:n.utilService.getYearFromISO(c.fecha),textColor:"black",backgroundColor:"aure"==c.quien?n.aureBackColor:n.carmenBackColor,id:c.id})}),n.highlightedDates=i,n.isLoading=!1)})()}ionChange(n){var o=this;return(0,m.Z)(function*(){let i=!1;const l=o.utilService.getYearFromISO(n.detail.value),c=o.highlightedDates.find(d=>d.date===l);if(c){o.isLoading=!0;let d=new u.a("delete","gestion-casa","turnos",null,null,c.id);yield o.myHttpService.ejecuteURL(d),i=!0}if(i&&!o.selectedPerson)return void o.loadList();if(!o.selectedPerson)return yield o.utilService.alert("Tienes que seleccionar a alguien"),void(i&&o.loadList());o.selectedDate=o.utilService.toISOString(new Date(n.detail.value));const k={fecha:o.selectedDate,quien:o.selectedPerson};o.isLoading=!0;let D=new u.a("post","gestion-casa","turnos",null,k);yield o.myHttpService.ejecuteURL(D),o.loadList()})()}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(P.f),e.Y36(T.F),e.Y36(u.y))},t.\u0275cmp=e.Xpm({type:t,selectors:[["turnos-casa"]],decls:12,vars:11,consts:[["locale","es-ES","presentation","date",3,"readonly","firstDayOfWeek","highlightedDates","ionChange"],[3,"click"],[3,"outline","click",4,"ngIf"],[4,"ngIf"],[3,"outline","click"],["name","dots"]],template:function(n,o){1&n&&(e.TgZ(0,"ion-grid")(1,"ion-row")(2,"ion-col")(3,"ion-datetime",0),e.NdJ("ionChange",function(l){return o.havePermision&&o.ionChange(l)}),e.qZA()()(),e.TgZ(4,"ion-row")(5,"ion-col",1),e.NdJ("click",function(){return o.havePermision&&(o.selectedPerson="carmen")}),e._uU(6,"Carmen"),e.qZA(),e.TgZ(7,"ion-col",1),e.NdJ("click",function(){return o.havePermision&&(o.selectedPerson="carmen")}),e._uU(8,"Aure"),e.qZA(),e.TgZ(9,"ion-col"),e.YNc(10,y,2,1,"ion-chip",2),e.qZA()(),e.YNc(11,C,3,0,"ion-row",3),e.qZA()),2&n&&(e.xp6(3),e.Q6J("readonly",o.isLoading)("firstDayOfWeek",1)("highlightedDates",o.highlightedDates),e.xp6(2),e.Jzz("background-color: ",o.carmenBackColor,""),e.xp6(2),e.Jzz("background-color: ",o.aureBackColor,""),e.xp6(3),e.Q6J("ngIf",o.selectedPerson),e.xp6(1),e.Q6J("ngIf",o.isLoading))},dependencies:[h.O5,s.hM,s.wI,s.x4,s.jY,s.Nd,s.PQ,s.QI]}),t})()}];let L=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[f.Bz.forChild(S),f.Bz]}),t})(),Z=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[h.ez,p.u5,s.Pc,L]}),t})()}}]);