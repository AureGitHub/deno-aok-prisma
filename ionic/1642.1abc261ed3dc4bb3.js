"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1642],{1642:(z,v,l)=>{l.r(v),l.d(v,{AgendaPageModule:()=>G});var g=l(4755),S=l(9401),c=l(7002),m=l(9915),u=l(5861),_=l(8175),D=l(1699),M=l(6575),e=l(2504),y=l(7241),T=l(5591),A=l(6014),P=l(3720);const Z=["slider"];function E(a,r){if(1&a&&(e.TgZ(0,"ion-select-option",12),e._uU(1),e.qZA()),2&a){const t=r.$implicit;e.s9C("value",null==t?null:t.id),e.xp6(1),e.Oqu(t.cor)}}function O(a,r){if(1&a&&(e.TgZ(0,"ion-select-option",12),e._uU(1),e.qZA()),2&a){const t=r.$implicit;e.s9C("value",t),e.xp6(1),e.Oqu(t)}}function F(a,r){if(1&a&&(e.TgZ(0,"ion-col",13),e._uU(1),e.qZA()),2&a){const t=r.$implicit;e.xp6(1),e.Oqu(t.cor)}}const w=function(a){return{color:a}};function Y(a,r){1&a&&e._UZ(0,"ion-icon",18),2&a&&e.Q6J("ngStyle",e.VKq(1,w,r.$implicit))}const x=function(a,r,t,n){return{diasSeleccionado:a,"tuno-aure":r,"tuno-carmen":t,hoy:n}};function N(a,r){if(1&a){const t=e.EpF();e.TgZ(0,"ion-col",15),e.NdJ("click",function(){const o=e.CHM(t).$implicit,s=e.oxw(2);return e.KtG(s.selectDay(o))}),e.TgZ(1,"div",16)(2,"div"),e._uU(3),e.qZA(),e.TgZ(4,"div"),e.YNc(5,Y,1,3,"ion-icon",17),e.qZA()()()}if(2&a){const t=r.$implicit,n=e.oxw(2);e.Q6J("ngClass",e.l5B(3,x,(null==t?null:t.fecha)&&(null==t?null:t.fecha.getTime())===(null==n.dateSelected?null:n.dateSelected.getTime()),"aure"==t.turno,"carmen"==t.turno,(null==t?null:t.fecha)&&(null==t?null:t.fecha.getTime())===(null==n.today?null:n.today.getTime()))),e.xp6(3),e.hij(" ",null==t?null:t.dia," "),e.xp6(2),e.Q6J("ngForOf",t.lstTiposEvents)}}function J(a,r){if(1&a&&(e.TgZ(0,"ion-row"),e.YNc(1,N,6,8,"ion-col",14),e.qZA()),2&a){const t=r.$implicit;e.xp6(1),e.Q6J("ngForOf",t)}}let I=(()=>{class a{set eventSource(t){this.setEventosInCalendar(t)}constructor(t,n){this.languageService=t,this.utilService=n,this.slideOpts={initialSlide:1,speed:400},this.refreshEnvents=new e.vpe,this.SelectedDate=new e.vpe,this.dateSelected=null,this.dateParaMontarCalendar=new Date((new Date).getFullYear(),(new Date).getMonth(),(new Date).getDate()),this.today=new Date((new Date).getFullYear(),(new Date).getMonth(),(new Date).getDate()),this.months=[],this.Years=[],this.currentMonth=(new Date).getMonth(),this.currentYear=(new Date).getFullYear(),this.lstDiasMesinWeek=[]}ngOnInit(){this.setlanguaje(),this.Setyears(),this.getDiasMes(),this.TodayDesc=this.languageService.today[this.lan].des}changeDate(t,n){"month"==n?"add"==t?this.dateParaMontarCalendar.setMonth(this.dateParaMontarCalendar.getMonth()+1):"sub"==t&&this.dateParaMontarCalendar.setMonth(this.dateParaMontarCalendar.getMonth()-1):"year"==n&&("add"==t?this.dateParaMontarCalendar.setFullYear(this.dateParaMontarCalendar.getFullYear()+1):"sub"==t&&this.dateParaMontarCalendar.setFullYear(this.dateParaMontarCalendar.getFullYear()-1)),this.currentMonth=this.dateParaMontarCalendar.getMonth(),this.currentYear=this.dateParaMontarCalendar.getFullYear(),this.dateSelected=null,this.SelectedDate.emit(this.dateSelected),this.refreshEnvents.emit(this.dateParaMontarCalendar),this.getDiasMes()}setEventosInCalendar(t){t&&this.lstDiasMesinWeek.forEach(n=>{n.forEach(i=>{if(i.fecha){let o=t.filter(s=>this.utilService.getYearFromISO(s.fechag)==this.utilService.getYearFromISO(this.utilService.toISOString(i.fecha)));o.length>0&&(i.turno=o[0].turno),o=o.filter(s=>s.tipoagendaId),i.TotalEnventos=o.length,i.lstTiposEvents=[...new Set(o.map(s=>s.color))],i.eventsInDay=o,this.dateSelected&&this.utilService.getYearFromISO(this.utilService.toISOString(i.fecha))==this.utilService.getYearFromISO(this.utilService.toISOString(this.dateSelected))&&this.SelectedDate.emit(i)}})})}Setyears(){this.Years=[];for(var t=1930;t<(new Date).getFullYear()+10;t++)this.Years.push(t)}selectChangedMonth(t){this.currentMonth=parseInt(t.detail.value),this.dateParaMontarCalendar.setMonth(this.currentMonth),this.dateSelected&&this.currentMonth!=this.dateSelected.getMonth()&&(this.dateSelected=null),this.refreshEnvents.emit(this.dateParaMontarCalendar),this.getDiasMes()}selectChangedYear(t){this.currentYear=parseInt(t.detail.value),this.dateParaMontarCalendar.setFullYear(this.currentYear),this.currentYear!=this.dateSelected.getFullYear()&&(this.dateSelected=null),this.refreshEnvents.emit(this.dateParaMontarCalendar),this.getDiasMes()}setlanguaje(){this.months=this.languageService.MonthsName[this.lan],this.days=this.languageService.daysName[this.lan]}padWithZero(t,n){return String(t).padStart(n,"0")}FormatShortDate(t){return t?`${this.padWithZero(t.getDate(),2)}/${this.padWithZero(t.getMonth()+1,2)}/${t.getFullYear()}`:"-"}getDiasMes(){var t=[];this.lstDiasMesinWeek=[];let n=this.dateParaMontarCalendar.getFullYear(),i=this.dateParaMontarCalendar.getMonth()+1,o=new Date(n,i,0).getDate();var s=new Date(n,i-1,1).getDay();if("EN"===this.lan)for(var d=1;d<=s;d++)t.push({dia:h,indice:d});else if(0==s)for(d=1;d<=6;d++)t.push({dia:h,indice:d});else for(d=1;d<s;d++)t.push({dia:h,indice:d});for(var h=1;h<=o;h++){var C=new Date(n,i-1,h);d=C.getDay(),t.push({fecha:C,dia:h,indice:d,TotalEnventos:0})}for(var p=[],f=1;f<=t.length;f++)p.push(t[f-1]),f%7==0&&(this.lstDiasMesinWeek.push(p),p=[]);if(p.length>0){for(f=p.length;f<7;f++)p.push({});this.lstDiasMesinWeek.push(p)}}selectDay(t){this.dateSelected=t&&t.fecha?t.fecha:this.dateSelected,this.SelectedDate.emit(t)}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(P.T),e.Y36(y.f))},a.\u0275cmp=e.Xpm({type:a,selectors:[["aure-date"]],viewQuery:function(t,n){if(1&t&&e.Gf(Z,5),2&t){let i;e.iGM(i=e.CRH())&&(n.slider=i.first)}},inputs:{isLoading:"isLoading",lan:"lan",eventSource:"eventSource"},outputs:{refreshEnvents:"refreshEnvents",SelectedDate:"SelectedDate"},decls:17,vars:9,consts:[[1,"fondo-calendar",3,"ngClass"],[1,"CabeceraDetalle"],[1,"container"],[1,"selectDate"],["interface","popover","placeholder","Mes",3,"value","ionChange"],[3,"value",4,"ngFor","ngForOf"],["interface","popover","placeholder","A\xf1o",3,"value","ionChange"],[1,"hand",3,"click"],["name","chevron-back-outline"],["name","chevron-forward-outline"],["style","text-align: center;",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[3,"value"],[2,"text-align","center"],["style","text-align: center;",3,"ngClass","click",4,"ngFor","ngForOf"],[2,"text-align","center",3,"ngClass","click"],[2,"height","30px","text-align","center"],["style","font-size: 8px","name","ellipse",3,"ngStyle",4,"ngFor","ngForOf"],["name","ellipse",2,"font-size","8px",3,"ngStyle"]],template:function(t,n){1&t&&(e.TgZ(0,"ion-grid",0)(1,"ion-row",1)(2,"ion-col")(3,"div",2)(4,"div",3)(5,"ion-select",4),e.NdJ("ionChange",function(o){return n.selectChangedMonth(o)}),e.YNc(6,E,2,2,"ion-select-option",5),e.qZA(),e.TgZ(7,"ion-select",6),e.NdJ("ionChange",function(o){return n.selectChangedYear(o)}),e.YNc(8,O,2,2,"ion-select-option",5),e.qZA()(),e.TgZ(9,"div")(10,"ion-col",7),e.NdJ("click",function(){return n.changeDate("sub","month")}),e._UZ(11,"ion-icon",8),e.qZA(),e.TgZ(12,"ion-col",7),e.NdJ("click",function(){return n.changeDate("add","month")}),e._UZ(13,"ion-icon",9),e.qZA()()()()(),e.TgZ(14,"ion-row"),e.YNc(15,F,2,1,"ion-col",10),e.qZA(),e.YNc(16,J,2,1,"ion-row",11),e.qZA()),2&t&&(e.ekj("disabled",n.isLoading),e.Q6J("ngClass",n.isLoading?"fondo-calendar-disabled":"fondo-calendar"),e.xp6(5),e.s9C("value",n.currentMonth),e.xp6(1),e.Q6J("ngForOf",n.months),e.xp6(1),e.s9C("value",n.currentYear),e.xp6(1),e.Q6J("ngForOf",n.Years),e.xp6(7),e.Q6J("ngForOf",n.days),e.xp6(1),e.Q6J("ngForOf",n.lstDiasMesinWeek))},dependencies:[g.mk,g.sg,g.PC,c.wI,c.jY,c.gu,c.Nd,c.t9,c.n0,c.QI],styles:[".hoy[_ngcontent-%COMP%]{border:solid 1px green}.diasSeleccionado[_ngcontent-%COMP%]{border:solid 1px}.tuno-aure[_ngcontent-%COMP%]{color:#aaf029}.tuno-carmen[_ngcontent-%COMP%]{color:#fcfc92}.container[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between}.selectDate[_ngcontent-%COMP%]{display:flex;flex-direction:row}.fondo-calendar[_ngcontent-%COMP%]{background-color:#fff;color:#000}.fondo-calendar-disabled[_ngcontent-%COMP%]{color:#fff}.CabeceraDetalle[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;vertical-align:center}.cabeceraNameDay[_ngcontent-%COMP%]{background-color:#848484}.ColCabeceraIconNav[_ngcontent-%COMP%]{display:flex;font-size:13px;align-items:center;cursor:pointer}.CabeceraIconNav[_ngcontent-%COMP%]{background-color:#a9a9a9}.cabecera[_ngcontent-%COMP%], .dias[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.detalleDay[_ngcontent-%COMP%]{font-size:10px}.diaActual[_ngcontent-%COMP%]{font-weight:700;color:#0b3b0b}.diasConEnventos[_ngcontent-%COMP%]{color:#000;background-color:#6e6e6e;color:#fff}.Sub_Sup[_ngcontent-%COMP%]{font-size:8px}.diasConEnventosSeleccionado[_ngcontent-%COMP%]{background-color:#bdbdbd;color:#000}.diasSinConEnventosSeleccionado[_ngcontent-%COMP%]{background-color:#bdbdbd;color:#fff}"]}),a})();var k=l(3380);function b(a,r){if(1&a){const t=e.EpF();e.TgZ(0,"div")(1,"app-editor-entity",6),e.NdJ("saveEvent",function(i){e.CHM(t);const o=e.oxw();return e.KtG(o.save(i))})("deleteEvent",function(i){e.CHM(t);const o=e.oxw();return e.KtG(o.borrar(i))})("cancelEvent",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.cancelToolEntity())}),e.qZA()()}if(2&a){const t=e.oxw();e.xp6(1),e.Q6J("entity",t.entitySelected)("setEntity",t.entityDescripcion)("isSaving",t.isSaving)("isDeleting",t.isDeleting)("isAlta",t.isAlta)}}function Q(a,r){if(1&a){const t=e.EpF();e.TgZ(0,"ion-col")(1,"ion-chip",7),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.havePermisionTurno&&i.setTurno(""))}),e._uU(2,"Borrar"),e.qZA()()}2&a&&(e.xp6(1),e.Q6J("outline",!0))}const L=function(a){return{color:a,"text-transform":"uppercase"}};function j(a,r){if(1&a){const t=e.EpF();e.TgZ(0,"ion-card",9),e.NdJ("click",function(){const o=e.CHM(t).$implicit,s=e.oxw(2);return e.KtG(s.updateEvent(o))}),e.TgZ(1,"ion-card-title")(2,"span",10),e._uU(3),e.qZA()(),e.TgZ(4,"ion-card-content"),e._uU(5),e.qZA()()}if(2&a){const t=r.$implicit;e.xp6(2),e.Q6J("ngStyle",e.VKq(3,L,t.color)),e.xp6(1),e.Oqu(t.descripcion),e.xp6(2),e.hij(" ",t.observacion," ")}}function U(a,r){if(1&a&&(e.TgZ(0,"div"),e.YNc(1,j,6,5,"ion-card",8),e.qZA()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.eventInDay)}}const H=[{path:"",component:(()=>{class a{constructor(t,n,i){this.utilService=t,this.myHttpService=n,this.seguridadService=i,this.havePermisionTurno=!1,this.highlightedDates=[],this.entityName="agenda"}ngOnInit(){var t=this;return(0,u.Z)(function*(){const n=t.seguridadService.UserGet();t.havePermisionTurno=n.role==M.u.GOD,yield t.loadList(),t.TodayDate=new Date((new Date).getFullYear(),(new Date).getMonth(),(new Date).getDate())})()}setTurno(t){var n=this;return(0,u.Z)(function*(){if(!n.selectedDay)return;const o={fecha:n.utilService.toISOString(n.selectedDay),quien:t};let s=new _.a("post","gestion-casa","turnos","AllOperations",o);yield n.myHttpService.ejecuteURL(s),n.itemDaySelected.turno=t})()}loadList(){var t=this;return(0,u.Z)(function*(){let n=new _.a("get","gestion-casa","agenda");t.isLoading=!0,t.highlightedDates=[];const o=yield t.myHttpService.ejecuteURL(n);o&&(t.highlightedDates=o,t.isLoading=!1)})()}ionChange(t){return(0,u.Z)(function*(){})()}refreshEnvents(t){var n=this;return(0,u.Z)(function*(){yield n.loadList()})()}SelectedDate(t){var n=this;return(0,u.Z)(function*(){n.itemDaySelected=t,n.eventInDay=null==t?void 0:t.eventsInDay,n.selectedDay=null==t?void 0:t.fecha})()}addToolEntity(){const t=this.utilService.toISOString(this.selectedDay?this.selectedDay:new Date);this.entitySelected={fecha:t},this.entityDescripcion=D.Z.giveMeEntity(this.entityName)}cancelToolEntity(){this.entityDescripcion=null}updateEvent(t){this.entitySelected=t,this.entityDescripcion=D.Z.giveMeEntity(this.entityName)}save(t){var n=this;return(0,u.Z)(function*(){n.isSaving=!0;const i=t.id?"put":"post",o=t.id?t.id.toString():null,s=new _.a(i,"gestion-casa","agenda",null,t,o);yield n.myHttpService.ejecuteURL(s),n.entityDescripcion=null,n.isSaving=!1,n.loadList()})()}borrar(t){var n=this;return(0,u.Z)(function*(){n.isDeleting=!0;const o=t.id.toString(),s=new _.a("delete","gestion-casa","agenda",null,null,o);yield n.myHttpService.ejecuteURL(s),n.entityDescripcion=null,n.isDeleting=!1,n.loadList()})()}cancel(){}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(y.f),e.Y36(_.y),e.Y36(T.F))},a.\u0275cmp=e.Xpm({type:a,selectors:[["agenda-casa"]],decls:19,vars:8,consts:[[3,"isLoading","entityDescripcion","addToolEntity","cancelToolEntity"],[4,"ngIf"],["color","warning",3,"click"],["alt","Silhouette of a person's head","src","https://ionicframework.com/docs/img/demos/avatar.svg"],["color","success",3,"click"],[3,"isLoading","lan","eventSource","refreshEnvents","SelectedDate"],[3,"entity","setEntity","isSaving","isDeleting","isAlta","saveEvent","deleteEvent","cancelEvent"],[3,"outline","click"],["class","hand",3,"click",4,"ngFor","ngForOf"],[1,"hand",3,"click"],[3,"ngStyle"]],template:function(t,n){1&t&&(e.TgZ(0,"app-tool-entity",0),e.NdJ("addToolEntity",function(){return n.addToolEntity()})("cancelToolEntity",function(){return n.cancelToolEntity()}),e.qZA(),e.YNc(1,b,2,5,"div",1),e.TgZ(2,"ion-row")(3,"ion-row")(4,"ion-col")(5,"ion-chip",2),e.NdJ("click",function(){return n.havePermisionTurno&&n.setTurno("carmen")}),e.TgZ(6,"ion-avatar"),e._UZ(7,"img",3),e.qZA(),e.TgZ(8,"ion-label"),e._uU(9,"Carmen"),e.qZA()()(),e.TgZ(10,"ion-col")(11,"ion-chip",4),e.NdJ("click",function(){return n.havePermisionTurno&&n.setTurno("aure")}),e.TgZ(12,"ion-avatar"),e._UZ(13,"img",3),e.qZA(),e.TgZ(14,"ion-label"),e._uU(15,"Aure"),e.qZA()()(),e.YNc(16,Q,3,1,"ion-col",1),e.qZA()(),e.TgZ(17,"aure-date",5),e.NdJ("refreshEnvents",function(o){return n.refreshEnvents(o)})("SelectedDate",function(o){return n.SelectedDate(o)}),e.qZA(),e.YNc(18,U,2,1,"div",1)),2&t&&(e.Q6J("isLoading",n.isLoading)("entityDescripcion",n.entityDescripcion),e.xp6(1),e.Q6J("ngIf",n.entityDescripcion),e.xp6(15),e.Q6J("ngIf",n.havePermisionTurno),e.xp6(1),e.Q6J("isLoading",n.isLoading)("lan","ES")("eventSource",n.highlightedDates),e.xp6(1),e.Q6J("ngIf",n.eventInDay))},dependencies:[g.sg,g.O5,g.PC,c.BJ,c.PM,c.FN,c.Dq,c.hM,c.wI,c.Q$,c.Nd,A.G,I,k.d]}),a})()}];let q=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[m.Bz.forChild(H),m.Bz]}),a})();var $=l(7147);let G=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[g.ez,S.u5,c.Pc,q,$.q]}),a})()}}]);