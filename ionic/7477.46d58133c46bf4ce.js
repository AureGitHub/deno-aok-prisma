"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7477],{7477:(R,f,c)=>{c.r(f),c.d(f,{GastosPageModule:()=>F});var p=c(4755),y=c(9401),g=c(7002),h=c(7147),_=c(9915),u=c(5861),m=c(1699),d=c(9722),T=c(5916),v=c(6575),t=c(2504),w=c(7241),x=c(5591),C=c(6014),M=c(3380);function b(o,a){if(1&o&&(t.TgZ(0,"ion-col"),t._uU(1),t.qZA()),2&o){const e=a.$implicit;t.xp6(1),t.Oqu(e.name)}}function P(o,a){1&o&&(t.TgZ(0,"ion-row")(1,"ion-col"),t._UZ(2,"ion-spinner",15),t.qZA()())}function Z(o,a){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"span",20),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit,s=t.oxw().$implicit,l=t.oxw();return t.KtG(l.alert(s[i.prop+"_title"]))}),t._uU(2),t.qZA(),t.BQk()}if(2&o){const e=t.oxw().$implicit,n=t.oxw().$implicit;t.xp6(1),t.s9C("title",n[e.prop+"_title"]),t.xp6(1),t.Oqu(n[e.prop])}}function S(o,a){if(1&o&&(t.ynx(0),t.TgZ(1,"span"),t._uU(2),t.qZA(),t.BQk()),2&o){const e=t.oxw().$implicit,n=t.oxw().$implicit;t.xp6(2),t.Oqu(n[e.prop])}}function A(o,a){if(1&o&&(t.TgZ(0,"ion-col"),t.ynx(1,17),t.YNc(2,Z,3,2,"ng-container",18),t.YNc(3,S,3,1,"ng-container",19),t.BQk(),t.qZA()),2&o){const e=a.$implicit;t.xp6(1),t.Q6J("ngSwitch",e.type),t.xp6(1),t.Q6J("ngSwitchCase","text")}}function E(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"ion-row",16),t.NdJ("click",function(){const s=t.CHM(e).$implicit,l=t.oxw();return t.KtG(l.onSelect(s))}),t.YNc(1,A,4,2,"ion-col",4),t.qZA()}if(2&o){const e=a.$implicit,n=a.index,i=t.oxw();t.Udp("background-color",n%2?"#C8E5F8":"white")("font-weight",i.rowSelected==e?"bold":"normal"),t.xp6(1),t.Q6J("ngForOf",i.columns)}}function O(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"ion-col",21)(1,"span",22),t.NdJ("click",function(){const s=t.CHM(e).$implicit,l=t.oxw();return t.KtG(l.pagination(s))}),t._uU(2),t.qZA()()}if(2&o){const e=a.$implicit,n=t.oxw();t.ekj("page_actual",n.pageActual===e),t.xp6(2),t.Oqu(e)}}let G=(()=>{class o{set setRow(e){this.rows=this.formatRows(e)}set setCount(e){this.count=e,this.numberPagination=Math.trunc(this.count/this.limit),this.numberPagination+=this.count%this.limit?1:0;for(let n=1;n<=this.numberPagination&&n<6;n++)this.lstPaginacion.push(n)}constructor(){this.rowSelected=null,this.isLoading=!1,this.title="",this.columns=[],this.rows=[],this.count=0,this.lstPaginacion=[],this.pageActual=1,this.limit=0,this.page=new t.vpe,this.selected=new t.vpe}ngOnInit(){}formatRows(e){return e.forEach(n=>{this.columns.forEach(i=>{n[i.prop]&&"text"==i.type&&(n[`${i.prop}_title`]=n[i.prop],n[i.prop]=n[i.prop].substring(0,5).padEnd(8,"."))})}),e}pagination(e){if(this.pageActual==e)return;this.pageActual=e;let n=[e];e-1>0&&n.unshift(e-1),e-2>0&&n.unshift(e-2),e+1<=this.numberPagination&&n.push(e+1),e+2<=this.numberPagination&&n.push(e+2);const i=n.length,s=Math.max(...n);for(let r=1;r<=5-i;r++)s+r<=this.numberPagination&&n.push(s+r);const l=Math.min(...n);for(let r=1;r<=5-i;r++)l-r>0&&n.unshift(l-r);this.lstPaginacion=n,this.page.emit({offset:e-1})}onSelect(e){this.rowSelected=this.rowSelected==e?null:e,this.selected.emit(this.rowSelected)}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["my-table"]],inputs:{isLoading:"isLoading",title:"title",columns:"columns",setRow:"setRow",setCount:"setCount",limit:"limit"},outputs:{page:"page",selected:"selected"},decls:23,vars:9,consts:[[3,"fixed"],[1,"title"],["size","12"],[1,"cabecera-row"],[4,"ngFor","ngForOf"],[4,"ngIf"],["class","dato-row",3,"background-color","font-weight","click",4,"ngFor","ngForOf"],[1,"footer-row"],["size","3",1,"pagination-info"],["name","play-skip-back-outline",1,"hand",3,"click"],["name","chevron-back-outline",1,"hand",3,"click"],["class","number-pagination",3,"page_actual",4,"ngFor","ngForOf"],["name","chevron-forward-outline",1,"hand",3,"click"],[1,"pagination-end"],["name","play-skip-forward-outline",1,"hand",3,"click"],["name","dots"],[1,"dato-row",3,"click"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[3,"title","click"],[1,"number-pagination"],[1,"hand",3,"click"]],template:function(e,n){1&e&&(t.TgZ(0,"ion-grid",0)(1,"ion-row",1)(2,"ion-col",2),t._uU(3),t.qZA()(),t.TgZ(4,"ion-row",3),t.YNc(5,b,2,1,"ion-col",4),t.qZA(),t.YNc(6,P,3,0,"ion-row",5),t.YNc(7,E,2,5,"ion-row",6),t.TgZ(8,"ion-row",7)(9,"ion-col",8)(10,"span"),t._uU(11),t.qZA(),t.TgZ(12,"span"),t._uU(13),t.qZA()(),t.TgZ(14,"ion-col")(15,"ion-icon",9),t.NdJ("click",function(){return n.pagination(1)}),t.qZA()(),t.TgZ(16,"ion-col")(17,"ion-icon",10),t.NdJ("click",function(){return n.pageActual>1&&n.pagination(n.pageActual-1)}),t.qZA()(),t.YNc(18,O,3,3,"ion-col",11),t.TgZ(19,"ion-col")(20,"ion-icon",12),t.NdJ("click",function(){return n.pageActual<n.numberPagination&&n.pagination(n.pageActual+1)}),t.qZA()(),t.TgZ(21,"ion-col",13)(22,"ion-icon",14),t.NdJ("click",function(){return n.pagination(n.numberPagination)}),t.qZA()()()()),2&e&&(t.Q6J("fixed",!0),t.xp6(3),t.Oqu(n.title),t.xp6(2),t.Q6J("ngForOf",n.columns),t.xp6(1),t.Q6J("ngIf",n.isLoading),t.xp6(1),t.Q6J("ngForOf",n.rows),t.xp6(4),t.AsE("",n.rows.length,"/",n.count," total"),t.xp6(2),t.hij("",n.numberPagination," p\xe1ginas"),t.xp6(5),t.Q6J("ngForOf",n.lstPaginacion))},dependencies:[p.sg,p.O5,p.RF,p.n9,p.ED,g.wI,g.jY,g.gu,g.Nd,g.PQ],styles:[".title[_ngcontent-%COMP%]{text-align:center;background-color:#fff;font-size:18px}.cabecera-row[_ngcontent-%COMP%]{display:flex;align-items:center;text-align:left;color:#fff;background-color:#444242;font-weight:700;font-size:14px;height:40px}.dato-row[_ngcontent-%COMP%]{font-size:14px;text-align:left;border:solid 1px rgba(221,218,218,.89)}.footer-row[_ngcontent-%COMP%]{display:flex;align-items:center;height:40px;border:solid 1px black;padding:3px;margin-top:2px;font-size:10px;background-color:#f5f5f5}ion-icon[_ngcontent-%COMP%]{font-size:14px}.number-pagination[_ngcontent-%COMP%]{font-size:14px;text-align:center}.page_actual[_ngcontent-%COMP%]{background-color:navy;color:#fff}.pagination-end[_ngcontent-%COMP%]{display:flex;flex-direction:row}.pagination-info[_ngcontent-%COMP%]{display:flex;flex-direction:column}"]}),o})();function k(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"div")(1,"app-editor-entity",3),t.NdJ("saveEvent",function(i){t.CHM(e);const s=t.oxw();return t.KtG(s.save(i))})("deleteEvent",function(i){t.CHM(e);const s=t.oxw();return t.KtG(s.borrar(i))})("cancelEvent",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.cancelToolEntity())}),t.qZA()()}if(2&o){const e=t.oxw();t.xp6(1),t.Q6J("entity",e.entitySelected)("setEntity",e.entityDescripcion)("isSaving",e.isSaving)("isDeleting",e.isDeleting)("isAlta",e.isAlta)}}const J=[{path:"",component:(()=>{class o extends T.t{constructor(e,n,i){super(e),this.myHttpService=e,this.utilService=n,this.seguridadService=i,this.columns=[{name:"Fecha",prop:"fecha_p"},{name:"Tipo",prop:"descripcion"},{name:"Importe",prop:"importe"},{name:"Obs",prop:"obs_p",type:"text"}],this.entityName="gasto"}ngOnInit(){var e=this;return(0,u.Z)(function*(){e.user=e.seguridadService.UserGet(),e.setPage({offset:0})})()}setPage(e){var n=this;return(0,u.Z)(function*(){n.myHttpService.page.offset=e.offset;const i=new d.a("get",n.app,n.entityName);n.isLoading=!0,n.lstPrincipal=[];const s=yield n.myHttpService.ejecuteURL(i);n.lstPrincipal=s.data,n.myHttpService.page.count=s.count,yield n.ownloadList(),n.isLoading=!1})()}addToolEntity(){this.addToolEntityBase();const e=this.utilService.toISOString(new Date);this.entitySelected={fecha:e},this.entityDescripcion=m.Z.giveMeEntity(this.entityName)}selectItem(e){var n=this;return(0,u.Z)(function*(){if(!e)return n.entityDescripcion=null,void(n.entitySelected=null);n.selectItemBase(),"servicio"!=e.descripcion||n.user.role==v.u.GOD?(n.entitySelected=e,n.entityDescripcion=m.Z.giveMeEntity(n.entityName)):yield n.utilService.alert("Los gastos de tipo servicios no se pueden modificar/borrar")})()}save(e){var n=this;return(0,u.Z)(function*(){n.isSaving=!0;const i=n.isAlta?"post":"put",s=n.isAlta?null:e[n.pk].toString(),l=new d.a(i,n.app,n.entityName,null,e,s);yield n.myHttpService.ejecuteURL(l),n.entityDescripcion=null,n.isSaving=!1,n.setPage({offset:n.myHttpService.page.offset})})()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(d.y),t.Y36(w.f),t.Y36(x.F))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-gastos"]],features:[t.qOj],decls:3,vars:9,consts:[[3,"isLoading","entityDescripcion","addToolEntity","cancelToolEntity"],[4,"ngIf"],[3,"isLoading","title","columns","setRow","limit","setCount","page","selected"],[3,"entity","setEntity","isSaving","isDeleting","isAlta","saveEvent","deleteEvent","cancelEvent"]],template:function(e,n){1&e&&(t.TgZ(0,"app-tool-entity",0),t.NdJ("addToolEntity",function(){return n.addToolEntity()})("cancelToolEntity",function(){return n.cancelToolEntity()}),t.qZA(),t.YNc(1,k,2,5,"div",1),t.TgZ(2,"my-table",2),t.NdJ("page",function(s){return n.setPage(s)})("selected",function(s){return n.selectItem(s)}),t.qZA()),2&e&&(t.Q6J("isLoading",n.isLoading)("entityDescripcion",n.entityDescripcion),t.xp6(1),t.Q6J("ngIf",n.entityDescripcion),t.xp6(1),t.Q6J("isLoading",n.isLoading)("title","Gastos")("columns",n.columns)("setRow",n.lstPrincipal)("limit",n.myHttpService.page.limit)("setCount",n.myHttpService.page.count))},dependencies:[p.O5,C.G,M.d,G],styles:[".tableTitle[_ngcontent-%COMP%]{text-align:center;color:#fff;background-color:#444242;font-weight:700;font-size:14px}.tableRow[_ngcontent-%COMP%]{text-align:center;font-size:13px;border:1px solid;cursor:pointer;color:#000;background-color:#fff}.tableRow_pendientecobro[_ngcontent-%COMP%]{border:solid 1px red}.tableRowSeleded[_ngcontent-%COMP%]{text-align:center;color:#fff;background-color:#00008b;cursor:pointer}.tableRow[_ngcontent-%COMP%]:hover{color:#fff;background-color:#00008b}"]}),o})()}];let N=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[_.Bz.forChild(J),_.Bz]}),o})(),F=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[p.ez,y.u5,g.Pc,N,h.q]}),o})()}}]);